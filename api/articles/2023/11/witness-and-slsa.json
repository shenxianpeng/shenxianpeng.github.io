{"title":"Witness å’Œ SLSA ğŸ’ƒ","slug":"2023/11/witness-and-slsa","date":"2023-11-30T06:25:39.000Z","updated":"2024-04-03T06:02:32.462Z","comments":true,"path":"api/articles/2023/11/witness-and-slsa.json","excerpt":"ç”±äºè¿‘äº›å¹´é’ˆå¯¹è½¯ä»¶çš„ä¾›åº”é“¾çš„æ”»å‡»è¶Šæ¥è¶Šé¢‘ç¹ï¼Œå› æ­¤ Google åœ¨ 2021 æå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯è½¯ä»¶å·¥ä»¶ä¾›åº”é“¾çº§åˆ«ï¼ˆSupply chain Levels for Software Artifactsï¼Œâ€SLSAâ€ï¼‰æœ¬ç¯‡å°†ä»‹ç»åœ¨é GitHub ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•ç”Ÿæˆå’ŒéªŒè¯è½¯ä»¶å·¥ä»¶çš„æ¥æºï¼Œä»è€Œæé«˜ä½ çš„é¡¹ç›®çš„ SLSA Levelã€‚Witness æ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„è½¯ä»¶ä¾›åº”é“¾é£é™©ç®¡ç†æ¡†æ¶ï¼Œå®ƒèƒ½è‡ªåŠ¨ã€è§„èŒƒå’ŒéªŒè¯è½¯ä»¶å·¥ä»¶å‡ºå¤„ã€‚å®ƒæ˜¯ in-toto æ˜¯ CNCF ä¸‹çš„é¡¹ç›®ä¹‹ä¸€ã€‚å®ƒçš„æœ€åˆä½œè€…æ˜¯ Testifysecï¼Œåæ¥æèµ ç»™äº† in-totoã€‚ä»€ä¹ˆæ˜¯ WitnessWitness æ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¾›åº”é“¾å®‰å…¨æ¡†æ¶ï¼Œå¯åˆ›å»ºæ•´ä¸ªè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆSDLCï¼‰çš„è¯æ®ï¼ˆProvenanceï¼‰è·Ÿè¸ªï¼Œç¡®ä¿è½¯ä»¶ä»æºä»£ç åˆ°ç›®æ ‡çš„å®Œæ•´æ€§ã€‚å®ƒæ”¯æŒå¤§å¤šæ•°ä¸»è¦çš„ CI å’ŒåŸºç¡€æ¶æ„æä¾›å•†ï¼Œæ˜¯ç¡®ä¿è½¯ä»¶ä¾›åº”é“¾å®‰å…¨çš„å¤šåŠŸèƒ½ã€çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚å®‰å…¨ PKI (Public Key Infrastructure - å…¬é’¥åŸºç¡€è®¾æ–½)åˆ†å‘ç³»ç»Ÿçš„ä½¿ç”¨å’ŒéªŒè¯ Witness å…ƒæ•°æ®çš„èƒ½åŠ›è¿›ä¸€æ­¥å¢å¼ºäº†æµç¨‹çš„å®‰å…¨æ€§ï¼Œå¹¶æœ‰åŠ©äºå‡å°‘è®¸å¤šè½¯ä»¶ä¾›åº”é“¾æ”»å‡»å‘é‡ã€‚Witness çš„å·¥ä½œåŸç†æ˜¯å°è£…åœ¨æŒç»­é›†æˆæµç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¸ºè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆSDLCï¼‰ä¸­çš„æ¯ä¸ªæ“ä½œæä¾›è¯æ®è·Ÿè¸ªï¼Œè¿™æ ·å°±å¯ä»¥è¯¦ç»†ã€å¯éªŒè¯åœ°è®°å½•è½¯ä»¶æ˜¯å¦‚ä½•æ„å»ºçš„ã€ç”±è°æ„å»ºä»¥åŠä½¿ç”¨äº†å“ªäº›å·¥å…·ã€‚è¿™äº›è¯æ®å¯ç”¨äºè¯„ä¼°æ”¿ç­–åˆè§„æ€§ï¼Œæ£€æµ‹ä»»ä½•æ½œåœ¨çš„ç¯¡æ”¹æˆ–æ¶æ„æ´»åŠ¨ï¼Œå¹¶ç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·æˆ–æœºå™¨æ‰èƒ½å®Œæˆæµç¨‹ä¸­çš„æŸä¸€æ­¥éª¤ã€‚æ€»ç»“ - Witness å¯ä»¥åšä»€ä¹ˆéªŒè¯è½¯ä»¶ç”±è°æ„å»ºã€å¦‚ä½•æ„å»ºä»¥åŠä½¿ç”¨äº†å“ªäº›å·¥å…·æ£€æµ‹ä»»ä½•æ½œåœ¨çš„ç¯¡æ”¹æˆ–æ¶æ„æ´»åŠ¨ç¡®ä¿åªæœ‰ç»æˆæƒçš„ç”¨æˆ·æˆ–æœºå™¨æ‰èƒ½å®Œæˆæµç¨‹çš„æ¯ä¸€æ­¥åˆ†å‘è¯è¯ï¼ˆAttestationsï¼‰å’Œç­–ç•¥ï¼ˆPolicyï¼‰å¦‚ä½•ä½¿ç”¨ Witnessä¸»è¦åˆ†ä¸‰æ­¥ï¼šwitness run - è¿è¡Œæä¾›çš„å‘½ä»¤å¹¶è®°å½•æœ‰å…³æ‰§è¡Œçš„è¯è¯ã€‚witness sign - ä½¿ç”¨æä¾›çš„å¯†é’¥ç­¾ç½²æä¾›çš„æ–‡ä»¶ã€‚witness verify - éªŒè¯ witness ç­–ç•¥ã€‚å¿«é€Ÿå¼€å§‹è¿™æ˜¯æˆ‘åˆ›å»ºçš„ Witness Demo ä»“åº“ç”¨äºæ¼”ç¤º witness çš„å·¥ä½œæµç¨‹ï¼Œå…·ä½“å¯ä»¥æ ¹æ®å¦‚ä¸‹æ­¥éª¤è¿›è¡Œã€‚","covers":null,"content":"<p>ç”±äºè¿‘äº›å¹´é’ˆå¯¹è½¯ä»¶çš„ä¾›åº”é“¾çš„æ”»å‡»è¶Šæ¥è¶Šé¢‘ç¹ï¼Œå› æ­¤ Google åœ¨ 2021 æå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯è½¯ä»¶å·¥ä»¶ä¾›åº”é“¾çº§åˆ«ï¼ˆSupply chain Levels for Software Artifactsï¼Œâ€SLSAâ€ï¼‰</p>\n<p>æœ¬ç¯‡å°†ä»‹ç»åœ¨<strong>é GitHub</strong> ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•ç”Ÿæˆå’ŒéªŒè¯è½¯ä»¶å·¥ä»¶çš„æ¥æºï¼Œä»è€Œæé«˜ä½ çš„é¡¹ç›®çš„ SLSA Levelã€‚</p>\n<p>Witness æ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„è½¯ä»¶ä¾›åº”é“¾é£é™©ç®¡ç†æ¡†æ¶ï¼Œå®ƒèƒ½è‡ªåŠ¨ã€è§„èŒƒå’ŒéªŒè¯è½¯ä»¶å·¥ä»¶å‡ºå¤„ã€‚å®ƒæ˜¯ in-toto æ˜¯ <a href=\"https://www.cncf.io/projects/in-toto/\">CNCF</a> ä¸‹çš„é¡¹ç›®ä¹‹ä¸€ã€‚å®ƒçš„æœ€åˆä½œè€…æ˜¯ Testifysecï¼Œåæ¥æèµ ç»™äº† <a href=\"https://in-toto.io/\">in-toto</a>ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯-Witness\"><a href=\"#ä»€ä¹ˆæ˜¯-Witness\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Witness\"></a>ä»€ä¹ˆæ˜¯ Witness</h2><p>Witness æ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¾›åº”é“¾å®‰å…¨æ¡†æ¶ï¼Œå¯åˆ›å»ºæ•´ä¸ªè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆSDLCï¼‰çš„è¯æ®ï¼ˆProvenanceï¼‰è·Ÿè¸ªï¼Œç¡®ä¿è½¯ä»¶ä»æºä»£ç åˆ°ç›®æ ‡çš„å®Œæ•´æ€§ã€‚å®ƒæ”¯æŒå¤§å¤šæ•°ä¸»è¦çš„ CI å’ŒåŸºç¡€æ¶æ„æä¾›å•†ï¼Œæ˜¯ç¡®ä¿è½¯ä»¶ä¾›åº”é“¾å®‰å…¨çš„å¤šåŠŸèƒ½ã€çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>\n<p>å®‰å…¨ PKI (Public Key Infrastructure - å…¬é’¥åŸºç¡€è®¾æ–½)åˆ†å‘ç³»ç»Ÿçš„ä½¿ç”¨å’ŒéªŒè¯ Witness å…ƒæ•°æ®çš„èƒ½åŠ›è¿›ä¸€æ­¥å¢å¼ºäº†æµç¨‹çš„å®‰å…¨æ€§ï¼Œå¹¶æœ‰åŠ©äºå‡å°‘è®¸å¤šè½¯ä»¶ä¾›åº”é“¾æ”»å‡»å‘é‡ã€‚</p>\n<p>Witness çš„å·¥ä½œåŸç†æ˜¯å°è£…åœ¨æŒç»­é›†æˆæµç¨‹ä¸­æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¸ºè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼ˆSDLCï¼‰ä¸­çš„æ¯ä¸ªæ“ä½œæä¾›è¯æ®è·Ÿè¸ªï¼Œè¿™æ ·å°±å¯ä»¥è¯¦ç»†ã€å¯éªŒè¯åœ°è®°å½•è½¯ä»¶æ˜¯å¦‚ä½•æ„å»ºçš„ã€ç”±è°æ„å»ºä»¥åŠä½¿ç”¨äº†å“ªäº›å·¥å…·ã€‚</p>\n<p>è¿™äº›è¯æ®å¯ç”¨äºè¯„ä¼°æ”¿ç­–åˆè§„æ€§ï¼Œæ£€æµ‹ä»»ä½•æ½œåœ¨çš„ç¯¡æ”¹æˆ–æ¶æ„æ´»åŠ¨ï¼Œå¹¶ç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·æˆ–æœºå™¨æ‰èƒ½å®Œæˆæµç¨‹ä¸­çš„æŸä¸€æ­¥éª¤ã€‚</p>\n<p>æ€»ç»“ - Witness å¯ä»¥åšä»€ä¹ˆ</p>\n<ul>\n<li>éªŒè¯è½¯ä»¶ç”±è°æ„å»ºã€å¦‚ä½•æ„å»ºä»¥åŠä½¿ç”¨äº†å“ªäº›å·¥å…·</li>\n<li>æ£€æµ‹ä»»ä½•æ½œåœ¨çš„ç¯¡æ”¹æˆ–æ¶æ„æ´»åŠ¨</li>\n<li>ç¡®ä¿åªæœ‰ç»æˆæƒçš„ç”¨æˆ·æˆ–æœºå™¨æ‰èƒ½å®Œæˆæµç¨‹çš„æ¯ä¸€æ­¥</li>\n<li>åˆ†å‘è¯è¯ï¼ˆAttestationsï¼‰å’Œç­–ç•¥ï¼ˆPolicyï¼‰</li>\n</ul>\n<h2 id=\"å¦‚ä½•ä½¿ç”¨-Witness\"><a href=\"#å¦‚ä½•ä½¿ç”¨-Witness\" class=\"headerlink\" title=\"å¦‚ä½•ä½¿ç”¨ Witness\"></a>å¦‚ä½•ä½¿ç”¨ Witness</h2><p>ä¸»è¦åˆ†ä¸‰æ­¥ï¼š</p>\n<ol>\n<li><code>witness run</code> - è¿è¡Œæä¾›çš„å‘½ä»¤å¹¶è®°å½•æœ‰å…³æ‰§è¡Œçš„è¯è¯ã€‚</li>\n<li><code>witness sign</code> - ä½¿ç”¨æä¾›çš„å¯†é’¥ç­¾ç½²æä¾›çš„æ–‡ä»¶ã€‚</li>\n<li><code>witness verify</code> - éªŒè¯ witness ç­–ç•¥ã€‚</li>\n</ol>\n<h3 id=\"å¿«é€Ÿå¼€å§‹\"><a href=\"#å¿«é€Ÿå¼€å§‹\" class=\"headerlink\" title=\"å¿«é€Ÿå¼€å§‹\"></a>å¿«é€Ÿå¼€å§‹</h3><p>è¿™æ˜¯æˆ‘åˆ›å»ºçš„ <a href=\"https://github.com/shenxianpeng/witness-demo\">Witness Demo ä»“åº“</a>ç”¨äºæ¼”ç¤º witness çš„å·¥ä½œæµç¨‹ï¼Œå…·ä½“å¯ä»¥æ ¹æ®å¦‚ä¸‹æ­¥éª¤è¿›è¡Œã€‚</p>\n<span id=\"more\"></span>\n\n<h4 id=\"å‡†å¤‡ç¯å¢ƒ\"><a href=\"#å‡†å¤‡ç¯å¢ƒ\" class=\"headerlink\" title=\"å‡†å¤‡ç¯å¢ƒ\"></a>å‡†å¤‡ç¯å¢ƒ</h4><p>å®‰è£… witnesssï¼Œä¸‹è½½ demo é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">bash &lt;(curl -s https://raw.githubusercontent.com/in-toto/witness/main/install-witness.sh)</span><br><span class=\"line\">Latest version of Witness is 0.1.14</span><br><span class=\"line\">Downloading <span class=\"keyword\">for</span> linux amd64 from https://github.com/in-toto/witness/releases/download/v0.1.14/witness_0.1.14_linux_amd64.tar.gz</span><br><span class=\"line\">expected checksum: f9b67ca04cb391cd854aec3397eb904392ff689dcd3c38305d38c444781a5a67</span><br><span class=\"line\">file checksum:     f9b67ca04cb391cd854aec3397eb904392ff689dcd3c38305d38c444781a5a67</span><br><span class=\"line\">witness v0.1.14-aa35c1f</span><br><span class=\"line\">Witness v0.1.14 has been installed at /usr/local/bin/witness</span><br><span class=\"line\"></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/shenxianpeng/witness-demo.git</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åˆ›å»ºé’¥åŒ™å¯¹\"><a href=\"#åˆ›å»ºé’¥åŒ™å¯¹\" class=\"headerlink\" title=\"åˆ›å»ºé’¥åŒ™å¯¹\"></a>åˆ›å»ºé’¥åŒ™å¯¹</h4><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl genpkey -algorithm ed25519 -outform PEM -out witness-demo-key.pem</span><br><span class=\"line\">openssl pkey -<span class=\"keyword\">in</span> witness-demo-key.pem -pubout &gt; witness-demo-pub.pem</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡†å¤‡-Witness-é…ç½®æ–‡ä»¶-witness-yaml\"><a href=\"#å‡†å¤‡-Witness-é…ç½®æ–‡ä»¶-witness-yaml\" class=\"headerlink\" title=\"å‡†å¤‡ Witness é…ç½®æ–‡ä»¶ .witness.yaml\"></a>å‡†å¤‡ Witness é…ç½®æ–‡ä»¶ <code>.witness.yaml</code></h3><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">run:</span></span><br><span class=\"line\">    <span class=\"attr\">signer-file-key-path:</span> <span class=\"string\">witness-demo-key.pem</span></span><br><span class=\"line\">    <span class=\"attr\">trace:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">verify:</span></span><br><span class=\"line\">    <span class=\"attr\">attestations:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">&quot;witness-demo-att.json&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">policy:</span> <span class=\"string\">policy-signed.json</span></span><br><span class=\"line\">    <span class=\"attr\">publickey:</span> <span class=\"string\">witness-demo-pub.pem</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\"><a href=\"#å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\" class=\"headerlink\" title=\"å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\"></a>å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness run --step build -o witness-demo-att.json -- python3 -m pip wheel --no-deps -w dist .</span><br><span class=\"line\">INFO    Using config file: .witness.yaml</span><br><span class=\"line\">INFO    Starting environment attestor...</span><br><span class=\"line\">INFO    Starting git attestor...</span><br><span class=\"line\">INFO    Starting material attestor...</span><br><span class=\"line\">INFO    Starting command-run attestor...</span><br><span class=\"line\">Processing /tmp/witness-demo</span><br><span class=\"line\">Building wheels for collected packages: witness-demo</span><br><span class=\"line\">  Running setup.py bdist_wheel for witness-demo: started</span><br><span class=\"line\">  Running setup.py bdist_wheel for witness-demo: finished with status &#x27;done&#x27;</span><br><span class=\"line\">  Stored in directory: /tmp/witness-demo/dist</span><br><span class=\"line\">Successfully built witness-demo</span><br><span class=\"line\">INFO    Starting product attestor...</span><br></pre></td></tr></table></figure>\n\n<p>å³åœ¨ä¹‹å‰çš„ build command ä¸­åŠ å…¥ <code>witness run</code> çš„ç›¸å…³å‘½ä»¤ã€‚</p>\n<h4 id=\"æŸ¥çœ‹å·²ç­¾åçš„-Attestation-çš„éªŒè¯æ•°æ®\"><a href=\"#æŸ¥çœ‹å·²ç­¾åçš„-Attestation-çš„éªŒè¯æ•°æ®\" class=\"headerlink\" title=\"æŸ¥çœ‹å·²ç­¾åçš„ Attestation çš„éªŒè¯æ•°æ®\"></a>æŸ¥çœ‹å·²ç­¾åçš„ Attestation çš„éªŒè¯æ•°æ®</h4><p>å› ä¸º Attestation æ•°æ®æ˜¯è¿›è¡Œçš„ base64 ç¼–ç ï¼Œå› æ­¤éœ€è¦è§£ç è¿›è¡ŒæŸ¥çœ‹</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> witness-demo-att.json | jq -r .payload | <span class=\"built_in\">base64</span> -d | jq</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä»¥ä¸‹æ˜¯éƒ¨åˆ†è¾“å‡º</span></span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;https://witness.dev/attestations/command-run/v0.1&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;attestation&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;cmd&quot;</span>: [</span><br><span class=\"line\">      <span class=\"string\">&quot;python3&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;-m&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;pip&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;wheel&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;--no-deps&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;-w&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;dist&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;.&quot;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">&quot;stdout&quot;</span>: <span class=\"string\">&quot;Processing /tmp/witness-demo\\nBuilding wheels for collected packages: witness-demo\\n  Running setup.py bdist_wheel for witness-demo: started\\n  Running setup.py bdist_wheel for witness-demo: finished with status &#x27;done&#x27;\\n  Stored in directory: /tmp/witness-demo/dist\\nSuccessfully built witness-demo\\n&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;exitcode&quot;</span>: 0</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">&quot;starttime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:19.227943473-05:00&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;endtime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.078517025-05:00&quot;</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;https://witness.dev/attestations/product/v0.1&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;attestation&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;dist/witness_demo-1.0.0-py3-none-any.whl&quot;</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&quot;mime_type&quot;</span>: <span class=\"string\">&quot;application/zip&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;digest&quot;</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;gitoid:sha1&quot;</span>: <span class=\"string\">&quot;gitoid:blob:sha1:b4b7210729998829c82208685837058f5ad614ab&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;gitoid:sha256&quot;</span>: <span class=\"string\">&quot;gitoid:blob:sha256:473a0f4c3be8a93681a267e3b1e9a7dcda1185436fe141f7749120a303721813&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;sha256&quot;</span>: <span class=\"string\">&quot;471985cd3b0d3e0101a1cbba8840819bfdc8d8f8cc19bd08add1e04be25b51ec&quot;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">&quot;starttime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.078579187-05:00&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;endtime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.081170078-05:00&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åˆ›å»º-Policy-æ–‡ä»¶\"><a href=\"#åˆ›å»º-Policy-æ–‡ä»¶\" class=\"headerlink\" title=\"åˆ›å»º Policy æ–‡ä»¶\"></a>åˆ›å»º Policy æ–‡ä»¶</h4><p><code>policy.json</code> ç”¨æ¥å®šä¹‰æˆ–è¦æ±‚ä¸€ä¸ªæ­¥éª¤ç”±å…·æœ‰ç‰¹å®šå±æ€§æˆ–æ»¡è¶³ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œä»è€Œè¦æ±‚éªŒè¯ Attestation æ‰èƒ½æˆåŠŸã€‚æ¯”å¦‚è¿™é‡Œçš„ <code>expires</code> å­—æ®µè¿‡æœŸäº†å³å°äºå½“å‰çš„æ—¶é—´ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ <code>witness verify</code> çš„æ—¶å€™å°±ä¼šå¤±è´¥ã€‚</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;expires&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;2033-12-17T23:57:40-05:00&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;steps&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;build&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;build&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;attestations&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/material/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/command-run/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/product/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">      <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;functionaries&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;publickeyid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">      <span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;publickeys&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;keyid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;key&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;B64_PUBLIC_KEY&#125;&#125;&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>æ›´å¤šå…³äº policy çš„å±æ€§å’Œè®¾ç½®å¯ä»¥å‚è€ƒè¿™é‡Œï¼š<a href=\"https://github.com/in-toto/witness/blob/main/docs/policy.md\">https://github.com/in-toto/witness/blob/main/docs/policy.md</a></p>\n<h3 id=\"ç»™-Policy-æ–‡ä»¶åšç­¾å\"><a href=\"#ç»™-Policy-æ–‡ä»¶åšç­¾å\" class=\"headerlink\" title=\"ç»™ Policy æ–‡ä»¶åšç­¾å\"></a>ç»™ Policy æ–‡ä»¶åšç­¾å</h3><p>åœ¨ç­¾åä¹‹å‰éœ€è¦å…ˆæ›¿æ¢åˆ° Policy æ–‡ä»¶çš„å˜é‡</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">id</span>=`<span class=\"built_in\">sha256sum</span> witness-demo-pub.pem | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>` &amp;&amp; sed -i <span class=\"string\">&quot;s/&#123;&#123;PUBLIC_KEY_ID&#125;&#125;/<span class=\"variable\">$id</span>/g&quot;</span> policy.json</span><br><span class=\"line\"></span><br><span class=\"line\">pubb64=`<span class=\"built_in\">cat</span> witness-demo-pub.pem | <span class=\"built_in\">base64</span> -w 0` &amp;&amp; sed -i <span class=\"string\">&quot;s/&#123;&#123;B64_PUBLIC_KEY&#125;&#125;/<span class=\"variable\">$pubb64</span>/g&quot;</span> policy.json</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åä½¿ç”¨ <code>witness sign</code> æ¥åšç­¾å</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness sign -f policy.json --signer-file-key-path witness-demo-key.pem --outfile policy-signed.json</span><br><span class=\"line\">INFO    Using config file: .witness.yaml</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\"><a href=\"#éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\" class=\"headerlink\" title=\"éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\"></a>éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚</h4><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness verify -f dist/witness_demo-1.0.0-py3-none-any.whl -a witness-demo-att.json -p policy-signed.json -k witness-demo-pub.pem </span><br><span class=\"line\">INFO    Using config file: .witness.yaml             </span><br><span class=\"line\">INFO    Verification succeeded                       </span><br><span class=\"line\">INFO    Evidence:                                    </span><br><span class=\"line\">INFO    0: witness-demo-att.json </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æœ€å\"><a href=\"#æœ€å\" class=\"headerlink\" title=\"æœ€å\"></a>æœ€å</h2><p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ witness é’ˆå¯¹ Non-GitHub é¡¹ç›®çš„æ¼”ç¤ºã€‚</p>\n<p>å¦‚æœä½ çš„é¡¹ç›®ä»£ç æ˜¯æ”¾åœ¨ GitHub ä¸Šçš„ï¼Œç›®å‰æœ€å®¹æ˜“ã€æœ€æµè¡Œçš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ <a href=\"https://github.com/slsa-framework/slsa-github-generator\">slsa-github-generator</a> ä¸€ä¸ªç”± <a href=\"https://github.com/slsa-framework\">SLSA Framework</a> å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œç„¶åä½¿ç”¨ <a href=\"https://github.com/slsa-framework/slsa-verifier\">slsa-verifier</a> æ¥éªŒè¯ Provenanceã€‚å…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href=\"https://shenxianpeng.github.io/2023/11/python-and-slsa/\">Python å’Œ SLSA ğŸ’ƒ</a></p>\n<hr>\n<p>è½¬è½½æœ¬ç«™æ–‡ç« è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ï¼Œè¯·å‹¿ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚æ¬¢è¿å…³æ³¨å…¬ä¼—å·ã€ŒDevOpsæ”»åŸç‹®ã€</p>\n","more":"<h4 id=\"å‡†å¤‡ç¯å¢ƒ\"><a href=\"#å‡†å¤‡ç¯å¢ƒ\" class=\"headerlink\" title=\"å‡†å¤‡ç¯å¢ƒ\"></a>å‡†å¤‡ç¯å¢ƒ</h4><p>å®‰è£… witnesssï¼Œä¸‹è½½ demo é¡¹ç›®</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">bash &lt;(curl -s https://raw.githubusercontent.com/in-toto/witness/main/install-witness.sh)</span><br><span class=\"line\">Latest version of Witness is 0.1.14</span><br><span class=\"line\">Downloading <span class=\"keyword\">for</span> linux amd64 from https://github.com/in-toto/witness/releases/download/v0.1.14/witness_0.1.14_linux_amd64.tar.gz</span><br><span class=\"line\">expected checksum: f9b67ca04cb391cd854aec3397eb904392ff689dcd3c38305d38c444781a5a67</span><br><span class=\"line\">file checksum:     f9b67ca04cb391cd854aec3397eb904392ff689dcd3c38305d38c444781a5a67</span><br><span class=\"line\">witness v0.1.14-aa35c1f</span><br><span class=\"line\">Witness v0.1.14 has been installed at /usr/local/bin/witness</span><br><span class=\"line\"></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/shenxianpeng/witness-demo.git</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åˆ›å»ºé’¥åŒ™å¯¹\"><a href=\"#åˆ›å»ºé’¥åŒ™å¯¹\" class=\"headerlink\" title=\"åˆ›å»ºé’¥åŒ™å¯¹\"></a>åˆ›å»ºé’¥åŒ™å¯¹</h4><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">openssl genpkey -algorithm ed25519 -outform PEM -out witness-demo-key.pem</span><br><span class=\"line\">openssl pkey -<span class=\"keyword\">in</span> witness-demo-key.pem -pubout &gt; witness-demo-pub.pem</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å‡†å¤‡-Witness-é…ç½®æ–‡ä»¶-witness-yaml\"><a href=\"#å‡†å¤‡-Witness-é…ç½®æ–‡ä»¶-witness-yaml\" class=\"headerlink\" title=\"å‡†å¤‡ Witness é…ç½®æ–‡ä»¶ .witness.yaml\"></a>å‡†å¤‡ Witness é…ç½®æ–‡ä»¶ <code>.witness.yaml</code></h3><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">run:</span></span><br><span class=\"line\">    <span class=\"attr\">signer-file-key-path:</span> <span class=\"string\">witness-demo-key.pem</span></span><br><span class=\"line\">    <span class=\"attr\">trace:</span> <span class=\"literal\">false</span></span><br><span class=\"line\"><span class=\"attr\">verify:</span></span><br><span class=\"line\">    <span class=\"attr\">attestations:</span></span><br><span class=\"line\">        <span class=\"bullet\">-</span> <span class=\"string\">&quot;witness-demo-att.json&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">policy:</span> <span class=\"string\">policy-signed.json</span></span><br><span class=\"line\">    <span class=\"attr\">publickey:</span> <span class=\"string\">witness-demo-pub.pem</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\"><a href=\"#å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\" class=\"headerlink\" title=\"å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­\"></a>å°†æ„å»ºæ­¥éª¤è¿›å…¥åˆ°è¯è¯ï¼ˆAttestationï¼‰ä¸­</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness run --step build -o witness-demo-att.json -- python3 -m pip wheel --no-deps -w dist .</span><br><span class=\"line\">INFO    Using config file: .witness.yaml</span><br><span class=\"line\">INFO    Starting environment attestor...</span><br><span class=\"line\">INFO    Starting git attestor...</span><br><span class=\"line\">INFO    Starting material attestor...</span><br><span class=\"line\">INFO    Starting command-run attestor...</span><br><span class=\"line\">Processing /tmp/witness-demo</span><br><span class=\"line\">Building wheels for collected packages: witness-demo</span><br><span class=\"line\">  Running setup.py bdist_wheel for witness-demo: started</span><br><span class=\"line\">  Running setup.py bdist_wheel for witness-demo: finished with status &#x27;done&#x27;</span><br><span class=\"line\">  Stored in directory: /tmp/witness-demo/dist</span><br><span class=\"line\">Successfully built witness-demo</span><br><span class=\"line\">INFO    Starting product attestor...</span><br></pre></td></tr></table></figure>\n\n<p>å³åœ¨ä¹‹å‰çš„ build command ä¸­åŠ å…¥ <code>witness run</code> çš„ç›¸å…³å‘½ä»¤ã€‚</p>\n<h4 id=\"æŸ¥çœ‹å·²ç­¾åçš„-Attestation-çš„éªŒè¯æ•°æ®\"><a href=\"#æŸ¥çœ‹å·²ç­¾åçš„-Attestation-çš„éªŒè¯æ•°æ®\" class=\"headerlink\" title=\"æŸ¥çœ‹å·²ç­¾åçš„ Attestation çš„éªŒè¯æ•°æ®\"></a>æŸ¥çœ‹å·²ç­¾åçš„ Attestation çš„éªŒè¯æ•°æ®</h4><p>å› ä¸º Attestation æ•°æ®æ˜¯è¿›è¡Œçš„ base64 ç¼–ç ï¼Œå› æ­¤éœ€è¦è§£ç è¿›è¡ŒæŸ¥çœ‹</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cat</span> witness-demo-att.json | jq -r .payload | <span class=\"built_in\">base64</span> -d | jq</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä»¥ä¸‹æ˜¯éƒ¨åˆ†è¾“å‡º</span></span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;https://witness.dev/attestations/command-run/v0.1&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;attestation&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;cmd&quot;</span>: [</span><br><span class=\"line\">      <span class=\"string\">&quot;python3&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;-m&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;pip&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;wheel&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;--no-deps&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;-w&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;dist&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;.&quot;</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"string\">&quot;stdout&quot;</span>: <span class=\"string\">&quot;Processing /tmp/witness-demo\\nBuilding wheels for collected packages: witness-demo\\n  Running setup.py bdist_wheel for witness-demo: started\\n  Running setup.py bdist_wheel for witness-demo: finished with status &#x27;done&#x27;\\n  Stored in directory: /tmp/witness-demo/dist\\nSuccessfully built witness-demo\\n&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;exitcode&quot;</span>: 0</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">&quot;starttime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:19.227943473-05:00&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;endtime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.078517025-05:00&quot;</span></span><br><span class=\"line\">&#125;,</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">&quot;type&quot;</span>: <span class=\"string\">&quot;https://witness.dev/attestations/product/v0.1&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;attestation&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;dist/witness_demo-1.0.0-py3-none-any.whl&quot;</span>: &#123;</span><br><span class=\"line\">      <span class=\"string\">&quot;mime_type&quot;</span>: <span class=\"string\">&quot;application/zip&quot;</span>,</span><br><span class=\"line\">      <span class=\"string\">&quot;digest&quot;</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&quot;gitoid:sha1&quot;</span>: <span class=\"string\">&quot;gitoid:blob:sha1:b4b7210729998829c82208685837058f5ad614ab&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;gitoid:sha256&quot;</span>: <span class=\"string\">&quot;gitoid:blob:sha256:473a0f4c3be8a93681a267e3b1e9a7dcda1185436fe141f7749120a303721813&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;sha256&quot;</span>: <span class=\"string\">&quot;471985cd3b0d3e0101a1cbba8840819bfdc8d8f8cc19bd08add1e04be25b51ec&quot;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"string\">&quot;starttime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.078579187-05:00&quot;</span>,</span><br><span class=\"line\">  <span class=\"string\">&quot;endtime&quot;</span>: <span class=\"string\">&quot;2023-11-29T05:15:20.081170078-05:00&quot;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"åˆ›å»º-Policy-æ–‡ä»¶\"><a href=\"#åˆ›å»º-Policy-æ–‡ä»¶\" class=\"headerlink\" title=\"åˆ›å»º Policy æ–‡ä»¶\"></a>åˆ›å»º Policy æ–‡ä»¶</h4><p><code>policy.json</code> ç”¨æ¥å®šä¹‰æˆ–è¦æ±‚ä¸€ä¸ªæ­¥éª¤ç”±å…·æœ‰ç‰¹å®šå±æ€§æˆ–æ»¡è¶³ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œä»è€Œè¦æ±‚éªŒè¯ Attestation æ‰èƒ½æˆåŠŸã€‚æ¯”å¦‚è¿™é‡Œçš„ <code>expires</code> å­—æ®µè¿‡æœŸäº†å³å°äºå½“å‰çš„æ—¶é—´ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œ <code>witness verify</code> çš„æ—¶å€™å°±ä¼šå¤±è´¥ã€‚</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;expires&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;2033-12-17T23:57:40-05:00&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;steps&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;build&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;build&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;attestations&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/material/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/command-run/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://witness.dev/attestations/product/v0.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;regopolicies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">      <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;functionaries&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;publickeyid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">      <span class=\"punctuation\">]</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;publickeys&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;keyid&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;PUBLIC_KEY_ID&#125;&#125;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;key&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&#123;&#123;B64_PUBLIC_KEY&#125;&#125;&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>æ›´å¤šå…³äº policy çš„å±æ€§å’Œè®¾ç½®å¯ä»¥å‚è€ƒè¿™é‡Œï¼š<a href=\"https://github.com/in-toto/witness/blob/main/docs/policy.md\">https://github.com/in-toto/witness/blob/main/docs/policy.md</a></p>\n<h3 id=\"ç»™-Policy-æ–‡ä»¶åšç­¾å\"><a href=\"#ç»™-Policy-æ–‡ä»¶åšç­¾å\" class=\"headerlink\" title=\"ç»™ Policy æ–‡ä»¶åšç­¾å\"></a>ç»™ Policy æ–‡ä»¶åšç­¾å</h3><p>åœ¨ç­¾åä¹‹å‰éœ€è¦å…ˆæ›¿æ¢åˆ° Policy æ–‡ä»¶çš„å˜é‡</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">id</span>=`<span class=\"built_in\">sha256sum</span> witness-demo-pub.pem | awk <span class=\"string\">&#x27;&#123;print $1&#125;&#x27;</span>` &amp;&amp; sed -i <span class=\"string\">&quot;s/&#123;&#123;PUBLIC_KEY_ID&#125;&#125;/<span class=\"variable\">$id</span>/g&quot;</span> policy.json</span><br><span class=\"line\"></span><br><span class=\"line\">pubb64=`<span class=\"built_in\">cat</span> witness-demo-pub.pem | <span class=\"built_in\">base64</span> -w 0` &amp;&amp; sed -i <span class=\"string\">&quot;s/&#123;&#123;B64_PUBLIC_KEY&#125;&#125;/<span class=\"variable\">$pubb64</span>/g&quot;</span> policy.json</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åä½¿ç”¨ <code>witness sign</code> æ¥åšç­¾å</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness sign -f policy.json --signer-file-key-path witness-demo-key.pem --outfile policy-signed.json</span><br><span class=\"line\">INFO    Using config file: .witness.yaml</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\"><a href=\"#éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\" class=\"headerlink\" title=\"éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚\"></a>éªŒè¯äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯å¦ç¬¦åˆæ”¿ç­–è¦æ±‚</h4><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">witness verify -f dist/witness_demo-1.0.0-py3-none-any.whl -a witness-demo-att.json -p policy-signed.json -k witness-demo-pub.pem </span><br><span class=\"line\">INFO    Using config file: .witness.yaml             </span><br><span class=\"line\">INFO    Verification succeeded                       </span><br><span class=\"line\">INFO    Evidence:                                    </span><br><span class=\"line\">INFO    0: witness-demo-att.json </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æœ€å\"><a href=\"#æœ€å\" class=\"headerlink\" title=\"æœ€å\"></a>æœ€å</h2><p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨ witness é’ˆå¯¹ Non-GitHub é¡¹ç›®çš„æ¼”ç¤ºã€‚</p>\n<p>å¦‚æœä½ çš„é¡¹ç›®ä»£ç æ˜¯æ”¾åœ¨ GitHub ä¸Šçš„ï¼Œç›®å‰æœ€å®¹æ˜“ã€æœ€æµè¡Œçš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ <a href=\"https://github.com/slsa-framework/slsa-github-generator\">slsa-github-generator</a> ä¸€ä¸ªç”± <a href=\"https://github.com/slsa-framework\">SLSA Framework</a> å®˜æ–¹æä¾›çš„å·¥å…·ï¼Œç„¶åä½¿ç”¨ <a href=\"https://github.com/slsa-framework/slsa-verifier\">slsa-verifier</a> æ¥éªŒè¯ Provenanceã€‚å…·ä½“å¯ä»¥å‚è€ƒæˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç«  <a href=\"https://shenxianpeng.github.io/2023/11/python-and-slsa/\">Python å’Œ SLSA ğŸ’ƒ</a></p>\n<hr>\n<p>è½¬è½½æœ¬ç«™æ–‡ç« è¯·æ³¨æ˜ä½œè€…å’Œå‡ºå¤„ï¼Œè¯·å‹¿ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚æ¬¢è¿å…³æ³¨å…¬ä¼—å·ã€ŒDevOpsæ”»åŸç‹®ã€</p>","categories":[{"name":"DevSecOps","path":"api/categories/DevSecOps.json"}],"tags":[{"name":"SLSA","path":"api/tags/SLSA.json"},{"name":"Witness","path":"api/tags/Witness.json"}]}