{"title":"A Code Coverage Tool - Squish Coco use examples","slug":"2019/05/squishcoco","date":"2019-05-21T07:53:55.000Z","updated":"2023-06-09T14:52:16.475Z","comments":true,"path":"api/articles/2019/05/squishcoco.json","excerpt":"PreparationYou need to ask for a free trial license and installYou will receive a mail with username&#x2F;password to login for downloadingI test it on the Windows platform, so I download the Windows installer, then install Squish Coco and Add-inInstalled Visual Studio 2010 or higher, I used VS2017 Professional","covers":["/2019/05/squishcoco/configuration-manager.png","/2019/05/squishcoco/squishcoco-add-in.png","/2019/05/squishcoco/squishcoco-result.png"],"content":"<h2 id=\"Preparation\"><a href=\"#Preparation\" class=\"headerlink\" title=\"Preparation\"></a>Preparation</h2><ol>\n<li>You need to ask for a <a href=\"https://www.froglogic.com/coco/free-trial/\">free trial license</a> and install<ul>\n<li>You will receive a mail with username&#x2F;password to login for downloading</li>\n</ul>\n</li>\n<li>I test it on the Windows platform, so I download the Windows installer, then install Squish Coco and Add-in</li>\n<li>Installed Visual Studio 2010 or higher, I used VS2017 Professional</li>\n</ol>\n<span id=\"more\"></span>\n\n<h2 id=\"Add-in\"><a href=\"#Add-in\" class=\"headerlink\" title=\"Add-in\"></a>Add-in</h2><ul>\n<li>go to ..squishcoco\\Setup, see quishCocoVSIX2017.vsix, double click, reopen VS2017, squishcoco will be there</li>\n</ul>\n<h2 id=\"Create-a-project\"><a href=\"#Create-a-project\" class=\"headerlink\" title=\"Create a project\"></a>Create a project</h2><p>Start Visual Studio and create a new C++ application</p>\n<ol>\n<li>Click on “File→New→Project…” to pop up the new project wizard.</li>\n<li>Choose a project type of “Visual C++2” and the “Win32 Console Application” template.</li>\n<li>Enter a project name of squishcoco_sample, then click the “OK” button.</li>\n<li>When the wizard’s second page appears, click the “Finish” button.</li>\n</ol>\n<p>At this stage the application is not yet instrumented, so now we will create a copy of the build.<br><img src=\"/2019/05/squishcoco/configuration-manager.png\" alt=\"configuration-manager\"></p>\n<ol>\n<li>Open the configuration manager by clicking “Build→Configuration Manager…”.</li>\n<li>In the “Configuration” column, select “New…” in the combobox.</li>\n<li>In the “New Project Configuration” dialog:<ol>\n<li>Enter Code Coverage in the “Name” field,</li>\n<li>Select Release or Debug in the “Copy settings from” selection dialog.</li>\n<li>Click the “OK” button.</li>\n</ol>\n</li>\n</ol>\n<p>Add test code</p>\n<p>squishcoco_sample.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// squishcoco_sample.cpp : Defines the entry point for the console application.</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stdafx.h&quot;</span></span></span><br><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"type\">int</span> <span class=\"title function_\">myprint</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> _tmain(<span class=\"type\">int</span> argc, _TCHAR* argv[])</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> age;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Enter your age: &quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>,&amp;age);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (age &gt; <span class=\"number\">0</span> &amp;&amp; age &lt;=<span class=\"number\">40</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re young guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (age &gt;<span class=\"number\">40</span> &amp;&amp; age &lt;=<span class=\"number\">70</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re midle guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (age &gt; <span class=\"number\">70</span> &amp;&amp; age &lt;=<span class=\"number\">100</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re old guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re awesome\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    myprint();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>myprint.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&quot;stdafx.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">myprint</span> <span class=\"params\">()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span> (<span class=\"string\">&quot;you have call printf function\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Activate-instrumentation\"><a href=\"#Activate-instrumentation\" class=\"headerlink\" title=\"Activate instrumentation\"></a>Activate instrumentation</h2><p>use the Microsoft® Visual Studio® Add-In:<br><img src=\"/2019/05/squishcoco/squishcoco-add-in.png\" alt=\"squishcoco-add-in\"></p>\n<ol>\n<li>Click “Tools→Code Coverage Build Mode…” to pop up the Squish Coco wizard.</li>\n<li>In the “Project:” selection dialog, select squishcoco_sample.</li>\n<li>In the selection dialog “Configuration:”, select Code Coverage.</li>\n<li>In the Configuration section at the bottom, select the radio button “Modify”, and then click on the button, “Enable code coverage for C++ projects”.</li>\n</ol>\n<p>The Code Coverage configuration has now been modified to generate code coverage information. The “SquishCoco” output window summarizes all the modifications that have been made:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">Modifying configuration &#x27;Code Coverage&#x27; for the project &#x27;squishcoco_sample&#x27; for the platform &#x27;Code Coverage|Win32&#x27;</span><br><span class=\"line\">    Compiler Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Linker Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Librarian Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    File Specific Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended for the file &#x27;squishcoco_sample.cpp&#x27;</span><br><span class=\"line\">Modifying configuration &#x27;Code Coverage&#x27; for the project &#x27;squishcoco_sample&#x27; for the platform &#x27;Code Coverage|x64&#x27;</span><br><span class=\"line\">    Compiler Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Linker Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Librarian Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    File Specific Configuration</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Build-project\"><a href=\"#Build-project\" class=\"headerlink\" title=\"Build project\"></a>Build project</h2><p>Build project will cause the executable squishcoco_sample.exe to be built and the code coverage instrumentation file squishcoco_sample.exe.csmes to be generated</p>\n<p>Double click on squishcoco_sample.exe.csmes to inspect this file in CoverageBrowser</p>\n<p>Right now there is no code coverage statistics visible in CoverageBrowser, this is because the application has not yet been executed. Click on squishcoco_sample.cpp in the source list to display the main function. All the instrumented lines are shown grayed out, to indicate that nothing has been executed.</p>\n<p>Now execute squishcoco_sample.exe by double clicking it. This will result in a file called squishcoco_sample.exe.csexe being generated. The file contains a code coverage snapshot which can be imported into Coverage Browser</p>\n<ol>\n<li>Click “File-&gt;Load Execution Report…”.</li>\n<li>Select the “File” item and enter the path of the squishcoco_sample.exe.csexe file.</li>\n<li>Click on the “Import” button.<br>This will cause the code coverage statistics to be updated. Now, in the source code window, the main function’s return statement will be colored green to indicate that this line has been executed.</li>\n</ol>\n<h2 id=\"Final-result\"><a href=\"#Final-result\" class=\"headerlink\" title=\"Final result\"></a>Final result</h2><p><img src=\"/2019/05/squishcoco/squishcoco-result.png\" alt=\"squishcoco-result\"></p>\n","more":"<h2 id=\"Add-in\"><a href=\"#Add-in\" class=\"headerlink\" title=\"Add-in\"></a>Add-in</h2><ul>\n<li>go to ..squishcoco\\Setup, see quishCocoVSIX2017.vsix, double click, reopen VS2017, squishcoco will be there</li>\n</ul>\n<h2 id=\"Create-a-project\"><a href=\"#Create-a-project\" class=\"headerlink\" title=\"Create a project\"></a>Create a project</h2><p>Start Visual Studio and create a new C++ application</p>\n<ol>\n<li>Click on “File→New→Project…” to pop up the new project wizard.</li>\n<li>Choose a project type of “Visual C++2” and the “Win32 Console Application” template.</li>\n<li>Enter a project name of squishcoco_sample, then click the “OK” button.</li>\n<li>When the wizard’s second page appears, click the “Finish” button.</li>\n</ol>\n<p>At this stage the application is not yet instrumented, so now we will create a copy of the build.<br><img src=\"/2019/05/squishcoco/configuration-manager.png\" alt=\"configuration-manager\"></p>\n<ol>\n<li>Open the configuration manager by clicking “Build→Configuration Manager…”.</li>\n<li>In the “Configuration” column, select “New…” in the combobox.</li>\n<li>In the “New Project Configuration” dialog:<ol>\n<li>Enter Code Coverage in the “Name” field,</li>\n<li>Select Release or Debug in the “Copy settings from” selection dialog.</li>\n<li>Click the “OK” button.</li>\n</ol>\n</li>\n</ol>\n<p>Add test code</p>\n<p>squishcoco_sample.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// squishcoco_sample.cpp : Defines the entry point for the console application.</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span> <span class=\"string\">&quot;stdafx.h&quot;</span></span></span><br><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"type\">int</span> <span class=\"title function_\">myprint</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> _tmain(<span class=\"type\">int</span> argc, _TCHAR* argv[])</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> age;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Enter your age: &quot;</span>);</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">&quot;%d&quot;</span>,&amp;age);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (age &gt; <span class=\"number\">0</span> &amp;&amp; age &lt;=<span class=\"number\">40</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re young guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (age &gt;<span class=\"number\">40</span> &amp;&amp; age &lt;=<span class=\"number\">70</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re midle guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (age &gt; <span class=\"number\">70</span> &amp;&amp; age &lt;=<span class=\"number\">100</span>)</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re old guys\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;You&#x27;re awesome\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    myprint();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>myprint.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">include</span><span class=\"string\">&quot;stdafx.h&quot;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">myprint</span> <span class=\"params\">()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"built_in\">printf</span> (<span class=\"string\">&quot;you have call printf function\\n&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Activate-instrumentation\"><a href=\"#Activate-instrumentation\" class=\"headerlink\" title=\"Activate instrumentation\"></a>Activate instrumentation</h2><p>use the Microsoft® Visual Studio® Add-In:<br><img src=\"/2019/05/squishcoco/squishcoco-add-in.png\" alt=\"squishcoco-add-in\"></p>\n<ol>\n<li>Click “Tools→Code Coverage Build Mode…” to pop up the Squish Coco wizard.</li>\n<li>In the “Project:” selection dialog, select squishcoco_sample.</li>\n<li>In the selection dialog “Configuration:”, select Code Coverage.</li>\n<li>In the Configuration section at the bottom, select the radio button “Modify”, and then click on the button, “Enable code coverage for C++ projects”.</li>\n</ol>\n<p>The Code Coverage configuration has now been modified to generate code coverage information. The “SquishCoco” output window summarizes all the modifications that have been made:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">...</span><br><span class=\"line\">Modifying configuration &#x27;Code Coverage&#x27; for the project &#x27;squishcoco_sample&#x27; for the platform &#x27;Code Coverage|Win32&#x27;</span><br><span class=\"line\">    Compiler Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Linker Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Librarian Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    File Specific Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended for the file &#x27;squishcoco_sample.cpp&#x27;</span><br><span class=\"line\">Modifying configuration &#x27;Code Coverage&#x27; for the project &#x27;squishcoco_sample&#x27; for the platform &#x27;Code Coverage|x64&#x27;</span><br><span class=\"line\">    Compiler Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Linker Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    Librarian Configuration</span><br><span class=\"line\">        Additional command line arguments &#x27; --cs-exclude-file-abs-regex=&quot;^.*\\\\squishcoco_sample\\\\[^\\\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#x27; are appended</span><br><span class=\"line\">    File Specific Configuration</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Build-project\"><a href=\"#Build-project\" class=\"headerlink\" title=\"Build project\"></a>Build project</h2><p>Build project will cause the executable squishcoco_sample.exe to be built and the code coverage instrumentation file squishcoco_sample.exe.csmes to be generated</p>\n<p>Double click on squishcoco_sample.exe.csmes to inspect this file in CoverageBrowser</p>\n<p>Right now there is no code coverage statistics visible in CoverageBrowser, this is because the application has not yet been executed. Click on squishcoco_sample.cpp in the source list to display the main function. All the instrumented lines are shown grayed out, to indicate that nothing has been executed.</p>\n<p>Now execute squishcoco_sample.exe by double clicking it. This will result in a file called squishcoco_sample.exe.csexe being generated. The file contains a code coverage snapshot which can be imported into Coverage Browser</p>\n<ol>\n<li>Click “File-&gt;Load Execution Report…”.</li>\n<li>Select the “File” item and enter the path of the squishcoco_sample.exe.csexe file.</li>\n<li>Click on the “Import” button.<br>This will cause the code coverage statistics to be updated. Now, in the source code window, the main function’s return statement will be colored green to indicate that this line has been executed.</li>\n</ol>\n<h2 id=\"Final-result\"><a href=\"#Final-result\" class=\"headerlink\" title=\"Final result\"></a>Final result</h2><p><img src=\"/2019/05/squishcoco/squishcoco-result.png\" alt=\"squishcoco-result\"></p>","categories":[{"name":"Coverage","path":"api/categories/Coverage.json"}],"tags":[{"name":"DevOps","path":"api/tags/DevOps.json"},{"name":"Coverage","path":"api/tags/Coverage.json"},{"name":"SquishCoco","path":"api/tags/SquishCoco.json"}]}