{"title":"Jenkins Linux agent configuration","slug":"2019/05/jenkins-linux-agent","date":"2019-05-12T11:49:20.000Z","updated":"2021-06-28T16:08:52.937Z","comments":true,"path":"api/articles/2019/05/jenkins-linux-agent.json","excerpt":null,"covers":null,"content":"<h2 id=\"Prepare-Java-runtime\"><a href=\"#Prepare-Java-runtime\" class=\"headerlink\" title=\"Prepare Java runtime\"></a>Prepare Java runtime</h2><h3 id=\"Check-if-had-installed-java\"><a href=\"#Check-if-had-installed-java\" class=\"headerlink\" title=\"Check if had installed java\"></a>Check if had installed java</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ java -version</span><br><span class=\"line\">openjdk version <span class=\"string\">\"1.8.0_65\"</span></span><br><span class=\"line\">OpenJDK Runtime Environment (build 1.8.0_65-b17)</span><br><span class=\"line\">OpenJDK 64-Bit Server VM (build 25.65-b01, mixed mode)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"if-not-Here-is-an-article-telling-you-how-to-install-it\"><a href=\"#if-not-Here-is-an-article-telling-you-how-to-install-it\" class=\"headerlink\" title=\"if not Here is an article telling you how to install it\"></a>if not Here is an <a href=\"https://www.javahelps.com/2015/03/install-oracle-jdk-in-ubuntu.html\" target=\"_blank\" rel=\"noopener\">article</a> telling you how to install it</h4><h2 id=\"Create-Node\"><a href=\"#Create-Node\" class=\"headerlink\" title=\"Create Node\"></a>Create Node</h2><h3 id=\"1-Jenkins-home-page-gt-Manage-Node-gt-New-Node-such-as-window-build-machine\"><a href=\"#1-Jenkins-home-page-gt-Manage-Node-gt-New-Node-such-as-window-build-machine\" class=\"headerlink\" title=\"1. Jenkins home page-&gt;Manage Node-&gt;New Node, such as window-build-machine\"></a>1. Jenkins home page-&gt;Manage Node-&gt;New Node, such as window-build-machine</h3><h4 id=\"2-List-Linux-agent-settings\"><a href=\"#2-List-Linux-agent-settings\" class=\"headerlink\" title=\"2. List Linux agent settings\"></a>2. List Linux agent settings</h4><table>\n<thead>\n<tr>\n<th>Items</th>\n<th>Settings</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Name</td>\n<td>Linux-build-machine</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>used for Linux build</td>\n</tr>\n<tr>\n<td>of executors</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Remote root directory</td>\n<td>/home/agent</td>\n</tr>\n<tr>\n<td>Labels</td>\n<td>Linux, build</td>\n</tr>\n<tr>\n<td>Usage</td>\n<td>Use this node as much as possible</td>\n</tr>\n<tr>\n<td>Launch method</td>\n<td>Launch agent agents via SSH</td>\n</tr>\n<tr>\n<td>Host</td>\n<td>192.168.1.112</td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>username/password</td>\n</tr>\n<tr>\n<td>Host Key Verification Strategy</td>\n<td>Manually trusted key Verification Strategy</td>\n</tr>\n<tr>\n<td>Availability</td>\n<td>Keep this agent online as much as paossible</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-How-to-set-credentials\"><a href=\"#3-How-to-set-credentials\" class=\"headerlink\" title=\"3. How to set credentials\"></a>3. How to set credentials</h4><table>\n<thead>\n<tr>\n<th>credentials</th>\n<th>configuration</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Domain</td>\n<td>Global credentials (unrestricted)</td>\n</tr>\n<tr>\n<td>Kind</td>\n<td>Username with password</td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>Global(Jenkins, nodes, items, all child items, etc)</td>\n</tr>\n<tr>\n<td>Username</td>\n<td>root</td>\n</tr>\n<tr>\n<td>Password</td>\n<td>mypassword</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Linux agent username &amp; password</td>\n</tr>\n</tbody></table>\n<h4 id=\"4-Save-then-Connect\"><a href=\"#4-Save-then-Connect\" class=\"headerlink\" title=\"4. Save then Connect\"></a>4. Save then Connect</h4><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Remoting version: 3.29</span><br><span class=\"line\">This is a Unix agent</span><br><span class=\"line\">Evacuated stdout</span><br><span class=\"line\">Agent successfully connected and online</span><br><span class=\"line\">SSHLauncher&#123;host&#x3D;&#39;192.168.1.112&#39;, port&#x3D;22, credentialsId&#x3D;&#39;d1cbab74-823d-41aa-abb7-8584859503d0&#39;, jvmOptions&#x3D;&#39;&#39;, javaPath&#x3D;&#39;&#x2F;usr&#x2F;bin&#x2F;java&#39;,</span><br><span class=\"line\">prefixStartSlaveCmd&#x3D;&#39;&#39;, suffixStartSlaveCmd&#x3D;&#39;&#39;, launchTimeoutSeconds&#x3D;210, maxNumRetries&#x3D;10, retryWaitTime&#x3D;15,</span><br><span class=\"line\">sshHostKeyVerificationStrategy&#x3D;hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy, tcpNoDelay&#x3D;true, trackCredentials&#x3D;true&#125;</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] Opening SSH connection to 192.168.1.112:22.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] SSH host key matches key seen previously for this host. Connection will be allowed.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] Authentication successful.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] The remote user&#39;s environment is:</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Troubleshooting\"><a href=\"#Troubleshooting\" class=\"headerlink\" title=\"Troubleshooting\"></a>Troubleshooting</h2><table>\n<thead>\n<tr>\n<th>Problem</th>\n<th>how to fix</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>[04/22/19 23:15:07] [SSH] WARNING: No entry currently exists in the Known Hosts file for this host. Connections will be denied until this new host and its associated key is added to the Known Hosts file.</td>\n<td>ssh-keyscan HOSTNAME &gt;&gt; known_hosts</td>\n</tr>\n<tr>\n<td>/var/lib/jenkins/.ssh/known_hosts [SSH] No Known Hosts file was found at /var/lib/jenkins/.ssh/known_hosts.</td>\n<td>changing the Host key verification strategy in LAUNCH METHOD from “Known Hosts file verification strategy” to “Manually trusted key verification strategy”</td>\n</tr>\n</tbody></table>\n","more":"<h2 id=\"Prepare-Java-runtime\"><a href=\"#Prepare-Java-runtime\" class=\"headerlink\" title=\"Prepare Java runtime\"></a>Prepare Java runtime</h2><h3 id=\"Check-if-had-installed-java\"><a href=\"#Check-if-had-installed-java\" class=\"headerlink\" title=\"Check if had installed java\"></a>Check if had installed java</h3><figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">$ java -version</span><br><span class=\"line\">openjdk version <span class=\"string\">\"1.8.0_65\"</span></span><br><span class=\"line\">OpenJDK Runtime Environment (build 1.8.0_65-b17)</span><br><span class=\"line\">OpenJDK 64-Bit Server VM (build 25.65-b01, mixed mode)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"if-not-Here-is-an-article-telling-you-how-to-install-it\"><a href=\"#if-not-Here-is-an-article-telling-you-how-to-install-it\" class=\"headerlink\" title=\"if not Here is an article telling you how to install it\"></a>if not Here is an <a href=\"https://www.javahelps.com/2015/03/install-oracle-jdk-in-ubuntu.html\" target=\"_blank\" rel=\"noopener\">article</a> telling you how to install it</h4><h2 id=\"Create-Node\"><a href=\"#Create-Node\" class=\"headerlink\" title=\"Create Node\"></a>Create Node</h2><h3 id=\"1-Jenkins-home-page-gt-Manage-Node-gt-New-Node-such-as-window-build-machine\"><a href=\"#1-Jenkins-home-page-gt-Manage-Node-gt-New-Node-such-as-window-build-machine\" class=\"headerlink\" title=\"1. Jenkins home page-&gt;Manage Node-&gt;New Node, such as window-build-machine\"></a>1. Jenkins home page-&gt;Manage Node-&gt;New Node, such as window-build-machine</h3><h4 id=\"2-List-Linux-agent-settings\"><a href=\"#2-List-Linux-agent-settings\" class=\"headerlink\" title=\"2. List Linux agent settings\"></a>2. List Linux agent settings</h4><table>\n<thead>\n<tr>\n<th>Items</th>\n<th>Settings</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Name</td>\n<td>Linux-build-machine</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>used for Linux build</td>\n</tr>\n<tr>\n<td>of executors</td>\n<td>1</td>\n</tr>\n<tr>\n<td>Remote root directory</td>\n<td>/home/agent</td>\n</tr>\n<tr>\n<td>Labels</td>\n<td>Linux, build</td>\n</tr>\n<tr>\n<td>Usage</td>\n<td>Use this node as much as possible</td>\n</tr>\n<tr>\n<td>Launch method</td>\n<td>Launch agent agents via SSH</td>\n</tr>\n<tr>\n<td>Host</td>\n<td>192.168.1.112</td>\n</tr>\n<tr>\n<td>Credentials</td>\n<td>username/password</td>\n</tr>\n<tr>\n<td>Host Key Verification Strategy</td>\n<td>Manually trusted key Verification Strategy</td>\n</tr>\n<tr>\n<td>Availability</td>\n<td>Keep this agent online as much as paossible</td>\n</tr>\n</tbody></table>\n<h4 id=\"3-How-to-set-credentials\"><a href=\"#3-How-to-set-credentials\" class=\"headerlink\" title=\"3. How to set credentials\"></a>3. How to set credentials</h4><table>\n<thead>\n<tr>\n<th>credentials</th>\n<th>configuration</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Domain</td>\n<td>Global credentials (unrestricted)</td>\n</tr>\n<tr>\n<td>Kind</td>\n<td>Username with password</td>\n</tr>\n<tr>\n<td>Scope</td>\n<td>Global(Jenkins, nodes, items, all child items, etc)</td>\n</tr>\n<tr>\n<td>Username</td>\n<td>root</td>\n</tr>\n<tr>\n<td>Password</td>\n<td>mypassword</td>\n</tr>\n<tr>\n<td>Description</td>\n<td>Linux agent username &amp; password</td>\n</tr>\n</tbody></table>\n<h4 id=\"4-Save-then-Connect\"><a href=\"#4-Save-then-Connect\" class=\"headerlink\" title=\"4. Save then Connect\"></a>4. Save then Connect</h4><figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">Remoting version: 3.29</span><br><span class=\"line\">This is a Unix agent</span><br><span class=\"line\">Evacuated stdout</span><br><span class=\"line\">Agent successfully connected and online</span><br><span class=\"line\">SSHLauncher&#123;host&#x3D;&#39;192.168.1.112&#39;, port&#x3D;22, credentialsId&#x3D;&#39;d1cbab74-823d-41aa-abb7-8584859503d0&#39;, jvmOptions&#x3D;&#39;&#39;, javaPath&#x3D;&#39;&#x2F;usr&#x2F;bin&#x2F;java&#39;,</span><br><span class=\"line\">prefixStartSlaveCmd&#x3D;&#39;&#39;, suffixStartSlaveCmd&#x3D;&#39;&#39;, launchTimeoutSeconds&#x3D;210, maxNumRetries&#x3D;10, retryWaitTime&#x3D;15,</span><br><span class=\"line\">sshHostKeyVerificationStrategy&#x3D;hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy, tcpNoDelay&#x3D;true, trackCredentials&#x3D;true&#125;</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] Opening SSH connection to 192.168.1.112:22.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] SSH host key matches key seen previously for this host. Connection will be allowed.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] Authentication successful.</span><br><span class=\"line\">[05&#x2F;11&#x2F;19 01:33:37] [SSH] The remote user&#39;s environment is:</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Troubleshooting\"><a href=\"#Troubleshooting\" class=\"headerlink\" title=\"Troubleshooting\"></a>Troubleshooting</h2><table>\n<thead>\n<tr>\n<th>Problem</th>\n<th>how to fix</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>[04/22/19 23:15:07] [SSH] WARNING: No entry currently exists in the Known Hosts file for this host. Connections will be denied until this new host and its associated key is added to the Known Hosts file.</td>\n<td>ssh-keyscan HOSTNAME &gt;&gt; known_hosts</td>\n</tr>\n<tr>\n<td>/var/lib/jenkins/.ssh/known_hosts [SSH] No Known Hosts file was found at /var/lib/jenkins/.ssh/known_hosts.</td>\n<td>changing the Host key verification strategy in LAUNCH METHOD from “Known Hosts file verification strategy” to “Manually trusted key verification strategy”</td>\n</tr>\n</tbody></table>\n","categories":[{"name":"Jenkins","path":"api/categories/Jenkins.json"}],"tags":[{"name":"Jenkins","path":"api/tags/Jenkins.json"}]}