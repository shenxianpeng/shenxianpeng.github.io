{"title":"Hexo添加Disqus留言功能","slug":"2019/07/add-disqus-to-hexo","date":"2019-07-07T12:20:50.000Z","updated":"2020-07-03T08:37:08.583Z","comments":true,"path":"api/articles/2019/07/add-disqus-to-hexo.json","excerpt":"在你的 Hexo 网站添加 Disqus去 Disqus 创建一个账号，在这个过程中有需要选择一个 shortname，完成后，你可以在设置页码找到你的 shortname1<br>https:&#x2F;&#x2F;YOURSHORTNAMEHERE.disqus.com&#x2F;admin&#x2F;settings&#x2F;general<br>在你Hexo博客里打开 _config.yml, 然后输入 disqus_shortnameand: YOURSHORTNAMEHERE，像这样：","covers":null,"content":"<h2 id=\"在你的-Hexo-网站添加-Disqus\"><a href=\"#在你的-Hexo-网站添加-Disqus\" class=\"headerlink\" title=\"在你的 Hexo 网站添加 Disqus\"></a>在你的 Hexo 网站添加 Disqus</h2><p>去 Disqus 创建一个账号，在这个过程中有需要选择一个 shortname，完成后，你可以在设置页码找到你的 shortname</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https:&#x2F;&#x2F;YOURSHORTNAMEHERE.disqus.com&#x2F;admin&#x2F;settings&#x2F;general</span><br></pre></td></tr></table></figure>\n\n<p>在你Hexo博客里打开 _config.yml, 然后输入 disqus_shortnameand: YOURSHORTNAMEHERE，像这样：</p>\n<a id=\"more\"></a>\n\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">disqus_shortname: myshortnamegoeshere</span><br><span class=\"line\">comments: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>也需要更改_config.yml文件如下，例如我的：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 修改默认 url: http://yoursite.com 为：</span></span><br><span class=\"line\">url: https://shenxianpeng.github.io</span><br></pre></td></tr></table></figure>\n\n<p>复制这段代码到blog\\themes\\landscape\\layout_partial\\footer.ejs</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> disqus_shortname = <span class=\"string\">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class=\"line\">  &lt;% <span class=\"keyword\">if</span> (page.permalink)&#123; %&gt;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> disqus_url = <span class=\"string\">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class=\"line\">  &lt;% &#125; %&gt;</span><br><span class=\"line\">  (<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> dsq = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span><br><span class=\"line\">    dsq.type = <span class=\"string\">'text/javascript'</span>;</span><br><span class=\"line\">    dsq.async = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    dsq.src = <span class=\"string\">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class=\"line\">    (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(dsq);</span><br><span class=\"line\">  &#125;)();</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>也需要复制这些文件到 footer.ejs 到最底部：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div id=<span class=\"string\">\"disqus_thread\"</span>&gt;&lt;<span class=\"regexp\">/div&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>最后最footer.ejs文件是这样的：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (theme.sidebar === <span class=\"string\">'bottom'</span>)&#123; %&gt;</span><br><span class=\"line\">  &lt;%- partial(<span class=\"string\">'_partial/sidebar'</span>) %&gt;</span><br><span class=\"line\">&lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class=\"line\">  &lt;script&gt;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> disqus_shortname = <span class=\"string\">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class=\"line\">    &lt;% <span class=\"keyword\">if</span> (page.permalink)&#123; %&gt;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> disqus_url = <span class=\"string\">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class=\"line\">    &lt;% &#125; %&gt;</span><br><span class=\"line\">    (<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> dsq = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span><br><span class=\"line\">      dsq.type = <span class=\"string\">'text/javascript'</span>;</span><br><span class=\"line\">      dsq.async = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      dsq.src = <span class=\"string\">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class=\"line\">      (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(dsq);</span><br><span class=\"line\">    &#125;)();</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;% &#125; %&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">&lt;footer id=\"footer\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;div class=\"outer\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;div id=\"footer-info\" class=\"inner\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &amp;copy; &lt;%= date(new Date(), 'YYYY') %&gt; &lt;%= config.author || config.title %&gt;&lt;br&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;%= __('powered_by') %&gt; &lt;a href=\"http:/</span><span class=\"regexp\">/hexo.io/</span><span class=\"string\">\" target=\"</span>_blank<span class=\"string\">\"&gt;Hexo&lt;/a&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"string\">  &lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"string\">&lt;/footer&gt;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">&lt;div id=\"</span>disqus_thread<span class=\"string\">\"&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>最后清理和构建</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo generate &amp;&amp; hexo server</span><br></pre></td></tr></table></figure>\n\n<p>现在你可以看到我的博客已经可以添加评论了 : )</p>\n","more":"<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">disqus_shortname: myshortnamegoeshere</span><br><span class=\"line\">comments: <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>也需要更改_config.yml文件如下，例如我的：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 修改默认 url: http://yoursite.com 为：</span></span><br><span class=\"line\">url: https://shenxianpeng.github.io</span><br></pre></td></tr></table></figure>\n\n<p>复制这段代码到blog\\themes\\landscape\\layout_partial\\footer.ejs</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> disqus_shortname = <span class=\"string\">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class=\"line\">  &lt;% <span class=\"keyword\">if</span> (page.permalink)&#123; %&gt;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> disqus_url = <span class=\"string\">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class=\"line\">  &lt;% &#125; %&gt;</span><br><span class=\"line\">  (<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> dsq = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span><br><span class=\"line\">    dsq.type = <span class=\"string\">'text/javascript'</span>;</span><br><span class=\"line\">    dsq.async = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    dsq.src = <span class=\"string\">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class=\"line\">    (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(dsq);</span><br><span class=\"line\">  &#125;)();</span><br><span class=\"line\">&lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>也需要复制这些文件到 footer.ejs 到最底部：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div id=<span class=\"string\">\"disqus_thread\"</span>&gt;&lt;<span class=\"regexp\">/div&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>最后最footer.ejs文件是这样的：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (theme.sidebar === <span class=\"string\">'bottom'</span>)&#123; %&gt;</span><br><span class=\"line\">  &lt;%- partial(<span class=\"string\">'_partial/sidebar'</span>) %&gt;</span><br><span class=\"line\">&lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;% <span class=\"keyword\">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class=\"line\">  &lt;script&gt;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> disqus_shortname = <span class=\"string\">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class=\"line\">    &lt;% <span class=\"keyword\">if</span> (page.permalink)&#123; %&gt;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> disqus_url = <span class=\"string\">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class=\"line\">    &lt;% &#125; %&gt;</span><br><span class=\"line\">    (<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> dsq = <span class=\"built_in\">document</span>.createElement(<span class=\"string\">'script'</span>);</span><br><span class=\"line\">      dsq.type = <span class=\"string\">'text/javascript'</span>;</span><br><span class=\"line\">      dsq.async = <span class=\"literal\">true</span>;</span><br><span class=\"line\">      dsq.src = <span class=\"string\">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class=\"line\">      (<span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'head'</span>)[<span class=\"number\">0</span>] || <span class=\"built_in\">document</span>.getElementsByTagName(<span class=\"string\">'body'</span>)[<span class=\"number\">0</span>]).appendChild(dsq);</span><br><span class=\"line\">    &#125;)();</span><br><span class=\"line\">  &lt;<span class=\"regexp\">/script&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;% &#125; %&gt;</span></span><br><span class=\"line\"><span class=\"regexp\"></span></span><br><span class=\"line\"><span class=\"regexp\">&lt;footer id=\"footer\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">  &lt;div class=\"outer\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">    &lt;div id=\"footer-info\" class=\"inner\"&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &amp;copy; &lt;%= date(new Date(), 'YYYY') %&gt; &lt;%= config.author || config.title %&gt;&lt;br&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">      &lt;%= __('powered_by') %&gt; &lt;a href=\"http:/</span><span class=\"regexp\">/hexo.io/</span><span class=\"string\">\" target=\"</span>_blank<span class=\"string\">\"&gt;Hexo&lt;/a&gt;</span></span><br><span class=\"line\"><span class=\"string\">    &lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"string\">  &lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"string\">&lt;/footer&gt;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">&lt;div id=\"</span>disqus_thread<span class=\"string\">\"&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>最后清理和构建</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo generate &amp;&amp; hexo server</span><br></pre></td></tr></table></figure>\n\n<p>现在你可以看到我的博客已经可以添加评论了 : )</p>","categories":[{"name":"Hexo","path":"api/categories/Hexo.json"}],"tags":[{"name":"Hexo","path":"api/tags/Hexo.json"}]}