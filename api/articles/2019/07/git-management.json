{"title":"Git 管理","slug":"2019/07/git-management","date":"2019-07-07T09:55:18.000Z","updated":"2023-12-15T09:25:16.947Z","comments":true,"path":"api/articles/2019/07/git-management.json","excerpt":"查找是否有遗漏提交从一个分支找到所有的 commit 和 ticket 号，然后去另外一个分支去查找这些提交是否也在这个分支里。","covers":null,"content":"<h2 id=\"查找是否有遗漏提交\"><a href=\"#查找是否有遗漏提交\" class=\"headerlink\" title=\"查找是否有遗漏提交\"></a>查找是否有遗漏提交</h2><p>从一个分支找到所有的 commit 和 ticket 号，然后去另外一个分支去查找这些提交是否也在这个分支里。</p>\n<span id=\"more\"></span>\n\n<p>找一个分支的所有 commit 和 ticket 号</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从 develop 分支上获取所有的 commit 和 ticket 号，然后根据 ticket 号进行排序</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span> origin/develop --pretty=oneline --abbrev-commit | <span class=\"built_in\">cut</span> -d<span class=\"string\">&#x27; &#x27;</span> -f2,1 | <span class=\"built_in\">sort</span> -t <span class=\"string\">&#x27; &#x27;</span> -k 2 &gt;&gt; develop_involve_tickets.txt</span><br><span class=\"line\"></span><br><span class=\"line\">--pretty=oneline    <span class=\"comment\"># 显示为一行</span></span><br><span class=\"line\">--abbrev-commit     <span class=\"comment\"># 显示短的提交号</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cut</span> --<span class=\"built_in\">help</span>          <span class=\"comment\"># 切出来所需要的字段</span></span><br><span class=\"line\">-d                  <span class=\"comment\"># 字段分隔符, &#x27; &#x27;分隔空格</span></span><br><span class=\"line\">-f                  <span class=\"comment\"># 只选择某些字段</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">sort</span> --<span class=\"built_in\">help</span>         <span class=\"comment\"># 利用 sort 将剪出来的字段进行排序</span></span><br><span class=\"line\">-t                  <span class=\"comment\"># 字段分隔， &#x27; &#x27;分隔空格</span></span><br><span class=\"line\">-k                  <span class=\"comment\"># 通过键进行键定义排序;KEYDEF 给出位置和类型</span></span><br></pre></td></tr></table></figure>\n\n<p>然后去另外一个分支去找是否有次提交</p>\n<p>由于在 SVN 时代时，每次修改都会在描述里添加 ticket 号，所以切换到 master 分支后，直接搜索所有 ticket 号是否存在就好了.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">filename=<span class=\"string\">&#x27;C:\\develop_involve_tickets.txt&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"built_in\">read</span> line</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span></span><br><span class=\"line\">    var=`grep -ir <span class=\"variable\">$line</span> src`</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [[ -z <span class=\"variable\">$var</span> ]];<span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;not found&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span> &gt;&gt; ../not_found_in_master.txt</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;found&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span> &gt;&gt; ../found_in_master.txt</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span> &lt; <span class=\"string\">&quot;<span class=\"variable\">$filename</span>&quot;</span></span><br></pre></td></tr></table></figure>\n","more":"<p>找一个分支的所有 commit 和 ticket 号</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从 develop 分支上获取所有的 commit 和 ticket 号，然后根据 ticket 号进行排序</span></span><br><span class=\"line\">git <span class=\"built_in\">log</span> origin/develop --pretty=oneline --abbrev-commit | <span class=\"built_in\">cut</span> -d<span class=\"string\">&#x27; &#x27;</span> -f2,1 | <span class=\"built_in\">sort</span> -t <span class=\"string\">&#x27; &#x27;</span> -k 2 &gt;&gt; develop_involve_tickets.txt</span><br><span class=\"line\"></span><br><span class=\"line\">--pretty=oneline    <span class=\"comment\"># 显示为一行</span></span><br><span class=\"line\">--abbrev-commit     <span class=\"comment\"># 显示短的提交号</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cut</span> --<span class=\"built_in\">help</span>          <span class=\"comment\"># 切出来所需要的字段</span></span><br><span class=\"line\">-d                  <span class=\"comment\"># 字段分隔符, &#x27; &#x27;分隔空格</span></span><br><span class=\"line\">-f                  <span class=\"comment\"># 只选择某些字段</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">sort</span> --<span class=\"built_in\">help</span>         <span class=\"comment\"># 利用 sort 将剪出来的字段进行排序</span></span><br><span class=\"line\">-t                  <span class=\"comment\"># 字段分隔， &#x27; &#x27;分隔空格</span></span><br><span class=\"line\">-k                  <span class=\"comment\"># 通过键进行键定义排序;KEYDEF 给出位置和类型</span></span><br></pre></td></tr></table></figure>\n\n<p>然后去另外一个分支去找是否有次提交</p>\n<p>由于在 SVN 时代时，每次修改都会在描述里添加 ticket 号，所以切换到 master 分支后，直接搜索所有 ticket 号是否存在就好了.</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\">filename=<span class=\"string\">&#x27;C:\\develop_involve_tickets.txt&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> <span class=\"built_in\">read</span> line</span><br><span class=\"line\"><span class=\"keyword\">do</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span></span><br><span class=\"line\">    var=`grep -ir <span class=\"variable\">$line</span> src`</span><br><span class=\"line\">    <span class=\"keyword\">if</span> [[ -z <span class=\"variable\">$var</span> ]];<span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;not found&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span> &gt;&gt; ../not_found_in_master.txt</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">&quot;found&quot;</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"variable\">$line</span> &gt;&gt; ../found_in_master.txt</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\"><span class=\"keyword\">done</span> &lt; <span class=\"string\">&quot;<span class=\"variable\">$filename</span>&quot;</span></span><br></pre></td></tr></table></figure>","categories":[{"name":"Git","path":"api/categories/Git.json"}],"tags":[{"name":"Git","path":"api/tags/Git.json"}]}