{"title":"Nightwatch 自动化测试中比较颜色","slug":"2017/10/nightwatch-auto-compare-colors","date":"2017-10-25T07:28:49.000Z","updated":"2024-01-31T04:49:00.686Z","comments":true,"path":"api/articles/2017/10/nightwatch-auto-compare-colors.json","excerpt":null,"covers":["/2017/10/nightwatch-auto-compare-colors/color.png"],"content":"<p>在做 Nightwatch 自动化测试中，出现需要比较颜色的时候如何来做？<br>基本的思路是首先需要取到这个 element 的颜色值，然后跟预期的颜色进行对比。<br>比如我要取下面这个会话窗口的颜色，选中这个图标，按 F12，查看这个图标的属性。发现Angular中的颜色属性不是 Elements 下，是在 Styles 下面，如何取到这个颜色值？</p>\n<p><img src=\"/2017/10/nightwatch-auto-compare-colors/color.png\" alt=\"element\"></p>\n<p>这里会用到 getCssProperty 这个方法，具体如何使用，请看如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">getChatColor</span>: <span class=\"keyword\">function</span>(<span class=\"params\">cb</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> chat = <span class=\"string\">&#x27;[ng-click=&quot;show()&quot;]&#x27;</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">getCssProperty</span>(<span class=\"string\">&#x27;@chat&#x27;</span>, <span class=\"string\">&#x27;background-color&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">cb</span>(result.<span class=\"property\">value</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>将上面的 getChatColor command 代码放到一个叫 chat.js 的 page 下面，然后在测试用例中这样调用这个 command</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&#x27;Test get color&#x27;</span>: <span class=\"keyword\">function</span> (<span class=\"params\">client</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> chat = client.<span class=\"property\">page</span>.<span class=\"title function_\">chat</span>();</span><br><span class=\"line\">    <span class=\"keyword\">let</span> chatColor;</span><br><span class=\"line\">    chat.<span class=\"title function_\">navigate</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    chat.<span class=\"title function_\">getChatColor</span>(<span class=\"keyword\">function</span>(<span class=\"params\">color</span>) &#123;</span><br><span class=\"line\">        chatColor = color;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    client.<span class=\"title function_\">perform</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        client.<span class=\"property\">assert</span>.<span class=\"title function_\">equal</span>(chatColor, <span class=\"string\">&#x27;rgba(50, 104, 152, 1)&#x27;</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>截图中看到的 background color 是 rgb(50, 104, 152), 但是 getChatColor 返回指是rgba，rgb 和 rgba 之间需要转化一下，a 表示透明度，取值0~1之间。</p>\n","more":"<p>在做 Nightwatch 自动化测试中，出现需要比较颜色的时候如何来做？<br>基本的思路是首先需要取到这个 element 的颜色值，然后跟预期的颜色进行对比。<br>比如我要取下面这个会话窗口的颜色，选中这个图标，按 F12，查看这个图标的属性。发现Angular中的颜色属性不是 Elements 下，是在 Styles 下面，如何取到这个颜色值？</p>\n<p><img src=\"/2017/10/nightwatch-auto-compare-colors/color.png\" alt=\"element\"></p>\n<p>这里会用到 getCssProperty 这个方法，具体如何使用，请看如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">getChatColor</span>: <span class=\"keyword\">function</span>(<span class=\"params\">cb</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> chat = <span class=\"string\">&#x27;[ng-click=&quot;show()&quot;]&#x27;</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">getCssProperty</span>(<span class=\"string\">&#x27;@chat&#x27;</span>, <span class=\"string\">&#x27;background-color&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">cb</span>(result.<span class=\"property\">value</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>;</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n\n<p>将上面的 getChatColor command 代码放到一个叫 chat.js 的 page 下面，然后在测试用例中这样调用这个 command</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&#x27;Test get color&#x27;</span>: <span class=\"keyword\">function</span> (<span class=\"params\">client</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> chat = client.<span class=\"property\">page</span>.<span class=\"title function_\">chat</span>();</span><br><span class=\"line\">    <span class=\"keyword\">let</span> chatColor;</span><br><span class=\"line\">    chat.<span class=\"title function_\">navigate</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    chat.<span class=\"title function_\">getChatColor</span>(<span class=\"keyword\">function</span>(<span class=\"params\">color</span>) &#123;</span><br><span class=\"line\">        chatColor = color;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    client.<span class=\"title function_\">perform</span>(<span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        client.<span class=\"property\">assert</span>.<span class=\"title function_\">equal</span>(chatColor, <span class=\"string\">&#x27;rgba(50, 104, 152, 1)&#x27;</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>截图中看到的 background color 是 rgb(50, 104, 152), 但是 getChatColor 返回指是rgba，rgb 和 rgba 之间需要转化一下，a 表示透明度，取值0~1之间。</p>\n","categories":[{"name":"Automation","path":"api/categories/Automation.json"}],"tags":[{"name":"Nightwatch","path":"api/tags/Nightwatch.json"},{"name":"Automation","path":"api/tags/Automation.json"}]}