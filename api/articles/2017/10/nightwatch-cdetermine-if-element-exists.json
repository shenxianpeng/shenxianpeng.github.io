{"title":"Nightwatch 验证元素是否存在","slug":"2017/10/nightwatch-cdetermine-if-element-exists","date":"2017-10-26T09:09:06.000Z","updated":"2024-04-21T04:06:28.102Z","comments":true,"path":"api/articles/2017/10/nightwatch-cdetermine-if-element-exists.json","excerpt":null,"covers":null,"content":"<h2 id=\"元素常用验证方法\"><a href=\"#元素常用验证方法\" class=\"headerlink\" title=\"元素常用验证方法\"></a>元素常用验证方法</h2><p>验证元素的值信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.containsText(<span class=\"string\">&#x27;@errorMessage&#x27;</span>, <span class=\"string\">&#x27;The email address is invalid.&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>验证元素是否可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.attributeEquals(<span class=\"string\">&#x27;@continueBtn&#x27;</span>, <span class=\"string\">&#x27;disabled&#x27;</span>, <span class=\"string\">&#x27;true&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">&#x27;@signInBtn&#x27;</span>).to.be.visible.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementVisible(<span class=\"string\">&#x27;signInBtn&#x27;</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素呈现</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">&#x27;@signInBtn&#x27;</span>).to.be.present.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementPresent(<span class=\"string\">&#x27;signInBtn&#x27;</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"判断元素是否存在\"><a href=\"#判断元素是否存在\" class=\"headerlink\" title=\"判断元素是否存在\"></a>判断元素是否存在</h2><p>用 Nightwatch 去判断一个 element 是否存在，如果存在执行如下操作，如果不存在做另外的操作。<br>这个在 Java 编写的自动化测试用例中可以用 try catch 可以解决，Nightwatch 试过不行。<br>另外看到 stackoverflow 上有通过判断 (result.status !&#x3D; -1)，没有解决我的问题。</p>\n<p>最后这样解决的，请看下面 tutorial.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tutorialCommands = &#123;</span><br><span class=\"line\">  <span class=\"attr\">notShowTutorial</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tutorialSection = <span class=\"variable language_\">this</span>.<span class=\"property\">section</span>.<span class=\"property\">tutorial</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">api</span>.<span class=\"title function_\">element</span>(<span class=\"string\">&#x27;css selector&#x27;</span>, <span class=\"string\">&#x27;.andes-dialog md-icon&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">value</span> &amp;&amp; result.<span class=\"property\">value</span>.<span class=\"property\">ELEMENT</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">pause</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.<span class=\"title function_\">click</span>(<span class=\"string\">&#x27;@doNotShowBtn&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">pause</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.<span class=\"title function_\">click</span>(<span class=\"string\">&#x27;@closeBtn&#x27;</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;no tutorial exists&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">commands</span>: [tutorialCommands],</span><br><span class=\"line\">  <span class=\"attr\">url</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`https://shenxianpeng.github.io/`</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">sections</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">tutorial</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">selector</span>: <span class=\"string\">&#x27;.andes-dialog&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">elements</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">closeBtn</span>: <span class=\"string\">&#x27;md-icon&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">doNotShowBtn</span>: <span class=\"string\">&#x27;md-checkbox .md-container&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>注意：这里的元素不能通过 section 的方式引用，例如这样，怀疑这是 Nightwatch 的 bug。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">tutorialSection.<span class=\"property\">api</span>.<span class=\"title function_\">element</span>(<span class=\"string\">&#x27;css selector&#x27;</span>, <span class=\"string\">&#x27;@closeBtn&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","more":"<h2 id=\"元素常用验证方法\"><a href=\"#元素常用验证方法\" class=\"headerlink\" title=\"元素常用验证方法\"></a>元素常用验证方法</h2><p>验证元素的值信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.containsText(<span class=\"string\">&#x27;@errorMessage&#x27;</span>, <span class=\"string\">&#x27;The email address is invalid.&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>验证元素是否可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.attributeEquals(<span class=\"string\">&#x27;@continueBtn&#x27;</span>, <span class=\"string\">&#x27;disabled&#x27;</span>, <span class=\"string\">&#x27;true&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">&#x27;@signInBtn&#x27;</span>).to.be.visible.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementVisible(<span class=\"string\">&#x27;signInBtn&#x27;</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素呈现</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">&#x27;@signInBtn&#x27;</span>).to.be.present.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementPresent(<span class=\"string\">&#x27;signInBtn&#x27;</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"判断元素是否存在\"><a href=\"#判断元素是否存在\" class=\"headerlink\" title=\"判断元素是否存在\"></a>判断元素是否存在</h2><p>用 Nightwatch 去判断一个 element 是否存在，如果存在执行如下操作，如果不存在做另外的操作。<br>这个在 Java 编写的自动化测试用例中可以用 try catch 可以解决，Nightwatch 试过不行。<br>另外看到 stackoverflow 上有通过判断 (result.status !&#x3D; -1)，没有解决我的问题。</p>\n<p>最后这样解决的，请看下面 tutorial.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tutorialCommands = &#123;</span><br><span class=\"line\">  <span class=\"attr\">notShowTutorial</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tutorialSection = <span class=\"variable language_\">this</span>.<span class=\"property\">section</span>.<span class=\"property\">tutorial</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">api</span>.<span class=\"title function_\">element</span>(<span class=\"string\">&#x27;css selector&#x27;</span>, <span class=\"string\">&#x27;.andes-dialog md-icon&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.<span class=\"property\">value</span> &amp;&amp; result.<span class=\"property\">value</span>.<span class=\"property\">ELEMENT</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">pause</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.<span class=\"title function_\">click</span>(<span class=\"string\">&#x27;@doNotShowBtn&#x27;</span>);</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">pause</span>(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.<span class=\"title function_\">click</span>(<span class=\"string\">&#x27;@closeBtn&#x27;</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;no tutorial exists&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">commands</span>: [tutorialCommands],</span><br><span class=\"line\">  <span class=\"attr\">url</span>: <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`https://shenxianpeng.github.io/`</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">sections</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">tutorial</span>: &#123;</span><br><span class=\"line\">      <span class=\"attr\">selector</span>: <span class=\"string\">&#x27;.andes-dialog&#x27;</span>,</span><br><span class=\"line\">      <span class=\"attr\">elements</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">closeBtn</span>: <span class=\"string\">&#x27;md-icon&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">doNotShowBtn</span>: <span class=\"string\">&#x27;md-checkbox .md-container&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>注意：这里的元素不能通过 section 的方式引用，例如这样，怀疑这是 Nightwatch 的 bug。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">tutorialSection.<span class=\"property\">api</span>.<span class=\"title function_\">element</span>(<span class=\"string\">&#x27;css selector&#x27;</span>, <span class=\"string\">&#x27;@closeBtn&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\">result</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":[{"name":"Automation","path":"api/categories/Automation.json"}],"tags":[{"name":"Nightwatch","path":"api/tags/Nightwatch.json"},{"name":"Automation","path":"api/tags/Automation.json"}]}