{"title":"Nightwatch 验证元素是否存在","slug":"2017/10/nightwatch-cdetermine-if-element-exists","date":"2017-10-26T09:09:06.000Z","updated":"2020-05-12T08:18:10.199Z","comments":true,"path":"api/articles/2017/10/nightwatch-cdetermine-if-element-exists.json","excerpt":null,"covers":null,"content":"<h2 id=\"元素常用验证方法\"><a href=\"#元素常用验证方法\" class=\"headerlink\" title=\"元素常用验证方法\"></a>元素常用验证方法</h2><p>验证元素的值信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.containsText(<span class=\"string\">'@errorMessage'</span>, <span class=\"string\">'The email address is invalid.'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>验证元素是否可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.attributeEquals(<span class=\"string\">'@continueBtn'</span>, <span class=\"string\">'disabled'</span>, <span class=\"string\">'true'</span>);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">'@signInBtn'</span>).to.be.visible.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementVisible(<span class=\"string\">'signInBtn'</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素呈现</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">'@signInBtn'</span>).to.be.present.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementPresent(<span class=\"string\">'signInBtn'</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"判断元素是否存在\"><a href=\"#判断元素是否存在\" class=\"headerlink\" title=\"判断元素是否存在\"></a>判断元素是否存在</h2><p>用 Nightwatch 去判断一个 element 是否存在，如果存在执行如下操作，如果不存在做另外的操作。<br>这个在 Java 编写的自动化测试用例中可以用 try catch 可以解决，Nightwatch 试过不行。<br>另外看到 stackoverflow 上有通过判断 (result.status != -1)，没有解决我的问题。</p>\n<p>最后这样解决的，请看下面 tutorial.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tutorialCommands = &#123;</span><br><span class=\"line\">  notShowTutorial: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tutorialSection = <span class=\"keyword\">this</span>.section.tutorial;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.api.element(<span class=\"string\">'css selector'</span>, <span class=\"string\">'.andes-dialog md-icon'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.value &amp;&amp; result.value.ELEMENT) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pause(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.click(<span class=\"string\">'@doNotShowBtn'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pause(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.click(<span class=\"string\">'@closeBtn'</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">'no tutorial exists'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  commands: [tutorialCommands],</span><br><span class=\"line\">  url: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`https://shenxianpeng.github.io/`</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  sections: &#123;</span><br><span class=\"line\">    tutorial: &#123;</span><br><span class=\"line\">      selector: <span class=\"string\">'.andes-dialog'</span>,</span><br><span class=\"line\">      elements: &#123;</span><br><span class=\"line\">        closeBtn: <span class=\"string\">'md-icon'</span>,</span><br><span class=\"line\">        doNotShowBtn: <span class=\"string\">'md-checkbox .md-container'</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>注意：这里的元素不能通过 section 的方式引用，例如这样，怀疑这是 Nightwatch 的 bug。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tutorialSection.api.element(<span class=\"string\">'css selector'</span>, <span class=\"string\">'@closeBtn'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","more":"<h2 id=\"元素常用验证方法\"><a href=\"#元素常用验证方法\" class=\"headerlink\" title=\"元素常用验证方法\"></a>元素常用验证方法</h2><p>验证元素的值信息</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.containsText(<span class=\"string\">'@errorMessage'</span>, <span class=\"string\">'The email address is invalid.'</span>)</span><br></pre></td></tr></table></figure>\n\n<p>验证元素是否可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .assert.attributeEquals(<span class=\"string\">'@continueBtn'</span>, <span class=\"string\">'disabled'</span>, <span class=\"string\">'true'</span>);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素可用</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">'@signInBtn'</span>).to.be.visible.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementVisible(<span class=\"string\">'signInBtn'</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<p>等待元素呈现</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">andesFormSection</span><br><span class=\"line\">    .expect.element(<span class=\"string\">'@signInBtn'</span>).to.be.present.before(5000);</span><br><span class=\"line\"><span class=\"comment\"># 或者</span></span><br><span class=\"line\">andesFormSection</span><br><span class=\"line\">    waitForElementPresent(<span class=\"string\">'signInBtn'</span>, 5000);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"判断元素是否存在\"><a href=\"#判断元素是否存在\" class=\"headerlink\" title=\"判断元素是否存在\"></a>判断元素是否存在</h2><p>用 Nightwatch 去判断一个 element 是否存在，如果存在执行如下操作，如果不存在做另外的操作。<br>这个在 Java 编写的自动化测试用例中可以用 try catch 可以解决，Nightwatch 试过不行。<br>另外看到 stackoverflow 上有通过判断 (result.status != -1)，没有解决我的问题。</p>\n<p>最后这样解决的，请看下面 tutorial.js</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> tutorialCommands = &#123;</span><br><span class=\"line\">  notShowTutorial: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> tutorialSection = <span class=\"keyword\">this</span>.section.tutorial;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.api.element(<span class=\"string\">'css selector'</span>, <span class=\"string\">'.andes-dialog md-icon'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result.value &amp;&amp; result.value.ELEMENT) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pause(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.click(<span class=\"string\">'@doNotShowBtn'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pause(<span class=\"number\">2000</span>);</span><br><span class=\"line\">        tutorialSection.click(<span class=\"string\">'@closeBtn'</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(<span class=\"string\">'no tutorial exists'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  commands: [tutorialCommands],</span><br><span class=\"line\">  url: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`https://shenxianpeng.github.io/`</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  sections: &#123;</span><br><span class=\"line\">    tutorial: &#123;</span><br><span class=\"line\">      selector: <span class=\"string\">'.andes-dialog'</span>,</span><br><span class=\"line\">      elements: &#123;</span><br><span class=\"line\">        closeBtn: <span class=\"string\">'md-icon'</span>,</span><br><span class=\"line\">        doNotShowBtn: <span class=\"string\">'md-checkbox .md-container'</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>注意：这里的元素不能通过 section 的方式引用，例如这样，怀疑这是 Nightwatch 的 bug。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tutorialSection.api.element(<span class=\"string\">'css selector'</span>, <span class=\"string\">'@closeBtn'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">result</span>) </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":[{"name":"Automation","path":"api/categories/Automation.json"}],"tags":[{"name":"Nightwatch","path":"api/tags/Nightwatch.json"},{"name":"Automation","path":"api/tags/Automation.json"}]}