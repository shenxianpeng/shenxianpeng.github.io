{"title":"How to fix \"Temporary Failure in name resolution\" in WSL","slug":"2022/09/fix-wsl-networking-issue","date":"2022-09-27T01:56:50.000Z","updated":"2025-04-12T23:47:19.741Z","comments":true,"path":"api/articles/2022/09/fix-wsl-networking-issue.json","excerpt":"ProblemI have encountered a problem when I ping google.com failed and return some error like “Temporary failure in name resolution”How to fixInside WSL2, create or append file: /etc/wsl.confPut the following lines in the file in order to ensure the your DNS changes do not get blown away sudo tee /etc/wsl.conf &lt;&lt; EOF<br>[network]<br>generateResolvConf = false<br>EOF<br>","covers":null,"content":"<h2 id=\"Problem\"><a href=\"#Problem\" class=\"headerlink\" title=\"Problem\"></a>Problem</h2><p>I have encountered a problem when I ping google.com failed and return some error like “Temporary failure in name resolution”</p>\n<h2 id=\"How-to-fix\"><a href=\"#How-to-fix\" class=\"headerlink\" title=\"How to fix\"></a>How to fix</h2><ol>\n<li><p>Inside WSL2, create or append file: <code>/etc/wsl.conf</code></p>\n</li>\n<li><p>Put the following lines in the file in order to ensure the your DNS changes do not get blown away</p>\n <figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/wsl.conf &lt;&lt; <span class=\"string\">EOF</span></span><br><span class=\"line\"><span class=\"string\">[network]</span></span><br><span class=\"line\"><span class=\"string\">generateResolvConf = false</span></span><br><span class=\"line\"><span class=\"string\">EOF</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<span id=\"more\"></span>\n<ol start=\"3\">\n<li>In a cmd windows (!!), run <code>wsl --shutdown</code></li>\n<li>Start WSL2</li>\n<li>Run the following inside WSL2 (line with search is optional)</li>\n</ol>\n  <figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">rm</span> -rf /etc/resolv.conf</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/resolv.conf &lt;&lt; <span class=\"string\">EOF</span></span><br><span class=\"line\"><span class=\"string\">search yourbase.domain.local</span></span><br><span class=\"line\"><span class=\"string\">nameserver 8.8.8.8</span></span><br><span class=\"line\"><span class=\"string\">nameserver 1.1.1.1</span></span><br><span class=\"line\"><span class=\"string\">EOF</span></span><br></pre></td></tr></table></figure>\n\n<p>  In my case, I can remove <code>/etc/resolv.conf</code> and error is “rm: cannot remove ‘&#x2F;etc&#x2F;resolv.conf’: Operation not permitted”</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># use following command instead fixed.</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> chattr -a -i /etc/resolv.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reference-links\"><a href=\"#Reference-links\" class=\"headerlink\" title=\"Reference links\"></a>Reference links</h2><blockquote>\n<p><a href=\"https://askubuntu.com/questions/1192347/temporary-failure-in-name-resolution-on-wsl\">https://askubuntu.com/questions/1192347/temporary-failure-in-name-resolution-on-wsl</a><br><a href=\"https://askubuntu.com/questions/125847/un-removable-etc-resolv-conf\">https://askubuntu.com/questions/125847/un-removable-etc-resolv-conf</a></p>\n</blockquote>\n<hr>\n<p>转载本站文章请注明作者和出处，请勿用于任何商业用途。欢迎关注公众号「DevOps攻城狮」</p>\n","more":"<ol start=\"3\">\n<li>In a cmd windows (!!), run <code>wsl --shutdown</code></li>\n<li>Start WSL2</li>\n<li>Run the following inside WSL2 (line with search is optional)</li>\n</ol>\n  <figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">rm</span> -rf /etc/resolv.conf</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/resolv.conf &lt;&lt; <span class=\"string\">EOF</span></span><br><span class=\"line\"><span class=\"string\">search yourbase.domain.local</span></span><br><span class=\"line\"><span class=\"string\">nameserver 8.8.8.8</span></span><br><span class=\"line\"><span class=\"string\">nameserver 1.1.1.1</span></span><br><span class=\"line\"><span class=\"string\">EOF</span></span><br></pre></td></tr></table></figure>\n\n<p>  In my case, I can remove <code>/etc/resolv.conf</code> and error is “rm: cannot remove ‘&#x2F;etc&#x2F;resolv.conf’: Operation not permitted”</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># use following command instead fixed.</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> chattr -a -i /etc/resolv.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Reference-links\"><a href=\"#Reference-links\" class=\"headerlink\" title=\"Reference links\"></a>Reference links</h2><blockquote>\n<p><a href=\"https://askubuntu.com/questions/1192347/temporary-failure-in-name-resolution-on-wsl\">https://askubuntu.com/questions/1192347/temporary-failure-in-name-resolution-on-wsl</a><br><a href=\"https://askubuntu.com/questions/125847/un-removable-etc-resolv-conf\">https://askubuntu.com/questions/125847/un-removable-etc-resolv-conf</a></p>\n</blockquote>\n<hr>\n<p>转载本站文章请注明作者和出处，请勿用于任何商业用途。欢迎关注公众号「DevOps攻城狮」</p>","categories":[{"name":"OS","path":"api/categories/OS.json"}],"tags":[{"name":"WSL","path":"api/tags/WSL.json"}]}