<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hello World</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="I’ve been QA Engineer for the last nine years, from Jun 2018 I am a Software Engineer.">
<meta property="og:type" content="website">
<meta property="og:title" content="Hello World">
<meta property="og:url" content="https://shenxianpeng.github.io/page/5/index.html">
<meta property="og:site_name" content="Hello World">
<meta property="og:description" content="I’ve been QA Engineer for the last nine years, from Jun 2018 I am a Software Engineer.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Xianpeng Shen">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hello World" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '[object Object]', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello World</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">非著名程序员的网络日志，把分享变成一种习惯。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://shenxianpeng.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-2019/08/jenkins-lock-resource" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/jenkins-lock-resource/" class="article-date">
  <time datetime="2019-08-09T16:00:00.000Z" itemprop="datePublished">2019-08-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jenkins/">Jenkins</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/jenkins-lock-resource/">如何通过 Jenkins 进行资源的锁定和释放</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="业务场景"><a href="#业务场景" class="headerlink" title="业务场景"></a>业务场景</h2><p>日常工作中需要切换到不同平台（包括 Linux, AIX, Windows, Solris, HP-UX）不同的版本进行开发和验证问题，但是由于虚拟机有限，并不能保证每个开发和测试都有所以平台的虚拟机并且安装了不同的版本，因此准备各种各样的开发和测试环境会花费很长时间。</p>
<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><p>对于这样的需求，一般都会首先想到 Docker；其次是从 Artifactory 取 Build 然后通过 CI 工具进行安装；最后从 Source Code 进行构建然后安装。</p>
<ul>
<li><p>先说 Docker，由于我们所支持的平台繁多，包括 Linux, AIX, Windows, Solris, HP-UX, Docker 只适用于 Linux 和 Windows，因此不能满足这样的需求。</p>
</li>
<li><p>由于其他原因我们的 Artifactory 暂时还不能使用，最后只能选择用 Source Code 进行构建然后进行安装。这两种方式都需要解决锁定资源以及释放资源的问题。如果当前环境有人正在使用，那么这台虚拟机的资源应该被锁住，不允许 Jenkins 再去调用这台正在使用的 node，以保证环境在使用过程中不被破坏。</p>
</li>
</ul>
<p>本文主要介绍如何通过 Jenkins Lockable Resources Plugin 来实现资源的上锁和解锁。</p>
<h2 id="演示-Demo"><a href="#演示-Demo" class="headerlink" title="演示 Demo"></a>演示 Demo</h2><ol>
<li><p>设置 Lockable Resources</p>
<ul>
<li>Jenkins -&gt; configuration -&gt; Lockable Resources Manager -&gt; Add Lockable Resource<br><img src="/2019/08/jenkins-lock-resource/config-lock-resource.png" alt="我设置了两个 Resources "><br>这里的 Labels 是你的 node 的 Label，在 Jenkins -&gt; Nodes 设置</li>
</ul>
</li>
<li><p>查看 Lockable Resources 资源池</p>
<p> <img src="/2019/08/jenkins-lock-resource/lock-resource-pool.png" alt="显示我有两个资源可用 "></p>
</li>
<li><p>测试锁资源</p>
<ul>
<li>这里我配置的是参数化类型的 Job，可以选择不同平台，不同仓库进行构建<br><img src="/2019/08/jenkins-lock-resource/build-with-parameters.png" alt=" Build With Parameters "> build-with-parameters</li>
<li>运行第一个 Job<br><img src="/2019/08/jenkins-lock-resource/build-with-parameters-1.png" alt=" 第一个 Job 已经运行 "></li>
<li>查看当前可用资源数量 Free resources = 1，看到已经被 #47 这个 Job 所使用<br><img src="/2019/08/jenkins-lock-resource/lock-resource-pool-1.png" alt="当前可用资源数为1"></li>
<li>继续运行第二个 Job<br><img src="/2019/08/jenkins-lock-resource/build-with-parameters-2.png" alt=" 第二个 Job 已经运行 "></li>
<li>查看当前可用资源数量 Free resources = 0，看到已经被 #48 这个 Job 所使用<br><img src="/2019/08/jenkins-lock-resource/lock-resource-pool-2.png" alt="当前可用资源数为0"></li>
<li>最关键是这一步，如果继续运行第三个 Job，是否能够被继续行呢<br><img src="/2019/08/jenkins-lock-resource/build-with-parameters-3.png" alt=" 第三个 Job 已经运行 "></li>
<li>可以看到这个任务没有开始执行，看下 log 是否真的没有被执行。通过日志发现，当前正在等待可用的资源<br><img src="/2019/08/jenkins-lock-resource/build-with-parameters-3-log.png" alt=" 第三个 Job log "></li>
</ul>
</li>
<li><p>测试释放锁</p>
<ul>
<li>现在释放一个资源，看下第三个 Job 是否能拿到资源，并且执行<br><img src="/2019/08/jenkins-lock-resource/unlock-job-1.png" alt=" 释放 Job 1 锁 "></li>
<li>从下图可以看到 第三个 Job 已经运行成功了<br><img src="/2019/08/jenkins-lock-resource/unlock-job-1-after.png" alt=" 第三个 Job 运行 "></li>
</ul>
</li>
</ol>
<h2 id="Jenkins-pipeline-代码"><a href="#Jenkins-pipeline-代码" class="headerlink" title="Jenkins pipeline 代码"></a>Jenkins pipeline 代码</h2><p>整个 pipeline 最关键的部分就是如何上锁和释放，这里是通过 lock 和 input message 来实现。</p>
<p>当前 Job 只要用户不点击 Yes，就会一直处于没有完成的状态，那么的它的锁会一直生效中。直到点击 Yes， Job 结束，锁也就释放了。</p>
<p>具体可以参考下面的 Jenkinsfile。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent &#123;</span><br><span class="line">        node &#123;</span><br><span class="line">            label <span class="string">'PreDevENV'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    options &#123;</span><br><span class="line">        lock(label: <span class="string">'PreDevENV'</span>, quantity: 1)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    parameters &#123;</span><br><span class="line">        choice(</span><br><span class="line">            name: <span class="string">'platform'</span>,</span><br><span class="line">            choices: [<span class="string">'Linux'</span>, <span class="string">'AIX'</span>, <span class="string">'Windows'</span>, <span class="string">'Solris'</span>, <span class="string">'HP-UX'</span>],</span><br><span class="line">            description: <span class="string">'Required: which platform do you want to build'</span>)</span><br><span class="line">        choice(</span><br><span class="line">            name: <span class="string">'repository'</span>,</span><br><span class="line">            choices: [<span class="string">'repo-0.1'</span>, <span class="string">'repo-1.1'</span>, <span class="string">'repo-2.1'</span>, <span class="string">'repo-3.1'</span>, <span class="string">'repo-4.1'</span>],</span><br><span class="line">            description: <span class="string">'Required: which repository do you want to build'</span>)</span><br><span class="line">        string(</span><br><span class="line">            name: <span class="string">'branch'</span>,</span><br><span class="line">            defaultValue: <span class="string">''</span>,</span><br><span class="line">            description: <span class="string">'Required: which branch do you want to build'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'git clone'</span>)&#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"git clone source"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'start build'</span>)&#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"start build"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'install build'</span>)&#123;</span><br><span class="line">            steps&#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"installing"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'unlock your resource'</span>)&#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                input message: <span class="string">"do you have finished?"</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"Yes, I have finished"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/08/jenkins-lock-resource/" data-id="ckc5mu1w1004aswfo92bzadbs" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/08/jenkins-lock-resource/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/08/jenkins-multi-branch-pipeline" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/jenkins-multi-branch-pipeline/" class="article-date">
  <time datetime="2019-08-05T16:00:00.000Z" itemprop="datePublished">2019-08-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jenkins/">Jenkins</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/jenkins-multi-branch-pipeline/">在大型企业里维护多分支流水线</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Jenkins 是 DevOps 领域里非常好的 CI/CD 工具，它凭借其独特的功能，几乎可以满足你一切的的业务要求。其中一个独特的功能是多分支流水线(Multi-branch 流水线)，可以动态配置流水线。但是，随着公司的发展，单独的多分支流水线并不能完全满足你的所有需求，特别是在涉及大型企业时，你需要考虑流水线的集中管理，治理，稳定性，限制和安全性等其他事项。因此对于具有 Jenkins 流水线的大规模 CI/CD 环境，你需要添加之前没有想到的更多功能。</p>
<p><img src="/2019/08/jenkins-multi-branch-pipeline/cover.jpeg" alt="jenkins multi branch"></p>
<h2 id="动态配置流水线"><a href="#动态配置流水线" class="headerlink" title="动态配置流水线"></a>动态配置流水线</h2><p>当一个开发人员创建一个新分支并将其推送到远程代码仓库时，Jenkins 会为这个新分支动态创建流水线。根据代码仓库，甚至也可以作为动态创建 Pull Request 流水线。这个动态功能在使用 Feature 分支或其他类似功能的团队中非常有用，由于本文的主题不是多分支流水线，你可以在<a href="https://jenkins.io/doc/tutorials/build-a-multibranch-pipeline-project/" target="_blank" rel="noopener">端到端多分支流水线项目创建</a>中找到详细信息和一些示例。</p>
<h2 id="流水线即代码"><a href="#流水线即代码" class="headerlink" title="流水线即代码"></a>流水线即代码</h2><p>在多分支流水线中，脚本存储在项目代码仓库中，这就是“流水线即代码”的概念。此外，当你拥有小型开发人员团队或项目没有大量分支时，它非常有用。这样，开发人员可以根据需要更改流水线，将更改推送到分支，并立即看到更改生效，但对于拥有数百或数千名拥有大量项目的开发人员的大型企业而言，这种方案就完成不可行了。</p>
<h2 id="集中式库"><a href="#集中式库" class="headerlink" title="集中式库"></a>集中式库</h2><p>当你的团队或项目增加时，是时候考虑一种方法，比如通过共享的的方式应该在所有项目中。从长远来看，这种“集中式库”变得非常关键，因为随着规模的扩大，流水线中出现了新的要求或变化，在这种情况下，手动更改每个流水线或脚本对管理员来说将是一场噩梦。因此，如果你在一个地方进行更改并且每个流水线都得到更新，那么拥有该集中式库将更加实用。这是 Jenkins <a href="https://jenkins.io/doc/book/pipeline/shared-libraries/" target="_blank" rel="noopener">共享库</a>概念的用武之地。有关详细信息，你可以访问<a href="https://jenkins.io/doc/book/pipeline/shared-libraries/" target="_blank" rel="noopener">该站点</a>。</p>
<p>即使你只有一个流水线，仍然可以使用集中式库。</p>
<h2 id="治理与稳定"><a href="#治理与稳定" class="headerlink" title="治理与稳定"></a>治理与稳定</h2><p>如果你的团队有对 CI/CD 一定了解的开发人员，并且你确信他们不会做出重大更改或编写脚本错误导致影响环境的稳定性，那么将流水线脚本放在代码中是很好的。但是，你真的确定吗？</p>
<p>有人很可能会意外删除流水线文件或者可能出现小错误，这些小错误都会影响 CI/CD 的稳定性。如果你在早期发现这些错误时很容易解决这些错误，如果没有，这些微小的变化或错误将可能比你想象的更严重的影响 CI/CD，它将被传播到不同项目中的所有分支或 tag，这会变得很难解决。</p>
<p>你需要将正确的流水线脚本推送到所有分支和/或代码仓库，或是要求每个开发人员提取最新的脚本，这种类型的问题集中式库这种更高级的方式来解决，除此之外，你的环境会因为有人可能会删除 Jenkins 文件或输入一些拼写错误带来风险。</p>
<h2 id="远程文件插件"><a href="#远程文件插件" class="headerlink" title="远程文件插件"></a>远程文件插件</h2><p>为了消除不必要的更改的风险并降低使用的库的复杂性，我们需要以某种方式将流水线脚本与项目/代码代码仓库分开，同时仍继续使用多分支流水线功能。为此，我们有<a href="https://plugins.jenkins.io/remote-file" target="_blank" rel="noopener">远程文件插件</a>。</p>
<p>这个插件使多分支流水线能够从其他代码仓库运行/加载流水线脚本，而不是将它们放在项目/代码代码仓库中，通过这个功能，你可以拥有一个单独的代码仓库，你可以在其中放置所有流水线脚本，并且只能为你自己提供访问权限。这样，你将拥有与集中式库相同的集中式流水线脚本代码仓库。此外，你可以将流水线脚本存储在集中式库本身中。</p>
<p>这个功能的好处是除了有访问权限的人之外，没有人能够在流水线脚本中进行更改。你在集中流水线脚本中所做的任何更改都将影响使用该脚本文件的所有多分支流水线。这样，你无需等待所有开发人员获取更新版本或将脚本推送到所有代码仓库上的所有分支。</p>
<p>另一个好处是，如果你将集中式流水线脚本放入 BitBucket 或 GitHub 等代码仓库中，你还将拥有代码审查功能。这样，你可以与其他人共享代码仓库，同时仍可限制或查看其他人所做的更改。</p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h2><p>在大型企业中创建 CI/CD 流水线并不容易，你需要考虑治理，限制，稳定性和安全性等概念。在此上下文中，借助 Jenkins 的其他功能，<a href="https://plugins.jenkins.io/remote-file" target="_blank" rel="noopener">Remote File Plugin</a> 提供了一个独特的功能，用于集中，维护和共享流水线脚本。</p>
<p>有关插件的详细信息，你可以访问插件的 Wiki 页面。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/08/jenkins-multi-branch-pipeline/" data-id="ckc5mu1w2004eswfocmn4eezp" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/08/jenkins-multi-branch-pipeline/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/git-branching-strategy" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/git-branching-strategy/" class="article-date">
  <time datetime="2019-07-28T15:27:21.000Z" itemprop="datePublished">2019-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/git/">Git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/git-branching-strategy/">Git branching strategy</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>随着近些年 Git 的快速普及，想必无论开发还是测试在日常工作中都要用到 Git。</p>
<p>对于刚刚接触的 Git 的人来说，打开一个 Git 仓库，面对十几个甚至几十个分支时，有的人不理解，有的人云里雾里，为什么会创建这么多分支？</p>
<p>对于开发需要知道如何通过 Git 分支来管理产品的开发和发布，尤其是对于大型的项目的开发，只有 master 和 develop 分支是无法满足产品管理和发布要求的，我们还需要其他分支以便更好的管理产品代码。</p>
<p>对于测试更多的了解开发过程及分支管理有助于测试及开展自动化测试用例，可以针对不同的分支进行测试用例的编写，在以后回归测试里可以通过分支或是 tag 找到对应的测试用例。</p>
<h2 id="Git-分支策略"><a href="#Git-分支策略" class="headerlink" title="Git 分支策略"></a>Git 分支策略</h2><p>这是一个大型的项目的 Git 分支管理策略，了解这张图可以涵盖 99% 的产品需求。</p>
<p><img src="/2019/07/git-branching-strategy/diagram.png" alt="大型项目的 Git 分支策略图"></p>
<p>上面这张图大体上分为 master, hotfix, release, develop 分支：</p>
<ul>
<li><p>master - 只用于存放稳定版本的提交，且只限于 merge 操作。每次发布成功后，要将 release 分支的代码 merge 到 master 和 develop 分支，并且在 master 上打上相应的 tag，如图里的 v1.1, v1.1.01 等。</p>
</li>
<li><p>develop - 开发分支是所有开发者最常用的分支，当前的 Bug 和 Features 都需要修复到这个分支上面去。需要每次创建 bugfix 或 feature 类型的分支，创建 Pull Request 进行代码 review，然后才能 merge 分支到 develop 分支上。</p>
</li>
<li><p>release - 发布分支是在产品 code freeze 后创建的， 这时候测试要开始大规模的测试了，新创建的 release 分支是不允许开发再往里面添加有关 feature 的代码，只有测试发现 bug 并被开发修复的代码才允许通过 Pull Request 的方式 merge 到 release 分支里。如果开发要提交 feature 的代码只能提交到 develop 分支里。等到产品成功发布后会将 release 分支 merge 到 master 分支并打上相应的 tag （版本号），还要将 release 分支 merge 到 develop 分支。</p>
</li>
<li><p>develop - 开发分支是所有开发者最常用的分支，当前的 Bug 和 Features 都需要修复到这个分支上面去。</p>
</li>
</ul>
<p>这个图有几个关键点：</p>
<ul>
<li>hotfix 分支是从最新的 hotfix 分支上创建的</li>
<li>hotfix 分支发布后将会合并到 develop 分支</li>
<li>release 分支是从 develop 分支上创建的</li>
<li>release 分支发布后将会合并到 develop 和 master 分支</li>
<li>release 分支上发现的缺陷将会修复到 release 分支</li>
</ul>
<p>如果你是那 1% 不能满足的产品需求，欢迎留言。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/git-branching-strategy/" data-id="ckc5mu1vz0043swfoa9ucfqq1" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/git-branching-strategy/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/branch/" rel="tag">Branch</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">Git</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/git-push-by-Jenkins" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/git-push-by-Jenkins/" class="article-date">
  <time datetime="2019-07-22T13:54:42.000Z" itemprop="datePublished">2019-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jenkins/">Jenkins</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/git-push-by-Jenkins/">通过 Jenkins 来提交修改的代码 git push by Jenkins</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在持续集成中，你可能需要通过 Jenkins 来修改代码，并且将修改后的代码提交到Git仓库里。怎么做呢？最方便的做法还是 Jenkins 提供对应的插件，但是很遗憾我没找到合适的。另外我也觉得通过脚本的方式来实现会更加稳定，不用担心 Jenkins 以及插件升级带来潜在不好用的可能。</p>
<p>以下 pipeline 片段供参考使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// This pipeline is used <span class="keyword">for</span> bumping build number</span><br><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line"></span><br><span class="line">    environment &#123;</span><br><span class="line">        MYGIT = credentials(<span class="string">"d1cbab74-823d-41aa-abb7"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    stages &#123;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">'Git clone repo'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">'git clone -b develop --depth 1 https://$MYGIT_USR:"$MYGIT_PSW"@github.com/shenxianpeng/blog.git'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">'Change code stage'</span>)&#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh <span class="string">''</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">'Git push to remote repo'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh label: <span class="string">''</span>, script: <span class="string">''</span><span class="string">'</span></span><br><span class="line"><span class="string">                cd blog</span></span><br><span class="line"><span class="string">                git add .</span></span><br><span class="line"><span class="string">                git commit -m "Bld # 1001"</span></span><br><span class="line"><span class="string">                git push https://$MYGIT_USR:"$MYGIT_PSW"@github.com/shenxianpeng/blog.git --all'</span><span class="string">''</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里面我所遇到最大的坑，我之前脚本是这样写的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">stage(<span class="string">'Git push to remote'</span>) &#123;</span><br><span class="line"></span><br><span class="line">    // not works script</span><br><span class="line"></span><br><span class="line">    steps &#123;</span><br><span class="line">        sh <span class="string">'cd blog'</span></span><br><span class="line">        sh <span class="string">'git add .'</span></span><br><span class="line">        sh <span class="string">'git commit -m "$&#123;JIRA_NO&#125; Bld # $&#123;BUILD_NO&#125;"'</span></span><br><span class="line">        sh <span class="string">'git push https://$MYGIT_USR:"$MYGIT_PSW"@github.com/shenxianpeng/blog.git --all'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在最后一个阶段提交代码时，shell 脚本不能使用单引号 ‘’，要使用三引号才行’’’ ‘’’。我在这里花了很多时间，一直找不到问题所在，因为我在上面的shell脚本使用的时候用单引号 ‘’ 可以正常 git clone 代码，但在提交代码时不行，最后我 Jenkins 的 Pipeline Syntax 生成的脚本，提交代码成功。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/git-push-by-Jenkins/" data-id="ckc5mu1vy0040swfo3wuj2b3m" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/git-push-by-Jenkins/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">Git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/execute-sudo-without-password" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/execute-sudo-without-password/" class="article-date">
  <time datetime="2019-07-16T13:07:39.000Z" itemprop="datePublished">2019-07-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linuxunix/">LinuxUnix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/execute-sudo-without-password/">Execute sudo without password</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在使用 Jenkins pipeline 的时候，在 Linux 需要用 root 来执行，我想通过 Jenkins pipeline 的语法来解决，但是只找到这种方式：<a href="https://jenkins.io/doc/pipeline/steps/ssh-steps/" target="_blank" rel="noopener">SSH Pipeline Steps</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">def remote = [:]</span><br><span class="line">remote.name = <span class="string">'test'</span></span><br><span class="line">remote.host = <span class="string">'test.domain.com'</span></span><br><span class="line">remote.user = <span class="string">'root'</span></span><br><span class="line">remote.password = <span class="string">'password'</span></span><br><span class="line">remote.allowAnyHosts = <span class="literal">true</span></span><br><span class="line">stage(<span class="string">'Remote SSH'</span>) &#123;</span><br><span class="line">    sshCommand remote: remote, <span class="built_in">command</span>: <span class="string">"ls -lrt"</span></span><br><span class="line">    sshCommand remote: remote, <span class="built_in">command</span>: <span class="string">"for i in &#123;1..5&#125;; do echo -n \"Loop \$i \"; date ; sleep 1; done"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">* <span class="built_in">command</span></span><br><span class="line">    * Type: String</span><br><span class="line">* dryRun (optional)</span><br><span class="line">    * Type: boolean</span><br><span class="line">* failOnError (optional)</span><br><span class="line">    * Type: boolean</span><br><span class="line">* remote (optional)</span><br><span class="line">    * Nested Choice of Objects</span><br><span class="line">* sudo (optional)</span><br><span class="line">    * Type: boolean</span><br></pre></td></tr></table></figure>

<p>从 example 来看需要提供的参数比较多，很多参数我已经在 Pipeline 的 environment 已经设置过了，这里再设置就显得不够优美，且限于没有足够的 example，你知道的 Jenkinsfile 调试非常痛苦和麻烦，我就没通过这种方式来尝试解决。</p>
<p>通过 Linux 设置来解决</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// open a shell console and <span class="built_in">type</span></span><br><span class="line">$ sudo visudo</span><br><span class="line"></span><br><span class="line">// <span class="built_in">type</span> your user name</span><br><span class="line">jenkins ALL=(ALL) NOPASSWD: ALL</span><br></pre></td></tr></table></figure>

<p>但即使这样设置，通过 Jenkins 执行 shell 脚本的时候还是出现如下问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo: no tty present and no askpass program specified</span><br></pre></td></tr></table></figure>

<p>最后通过如下脚本解决了我的问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Jenkinsfile</span><br><span class="line"></span><br><span class="line">environment &#123;</span><br><span class="line">    JENKINS = credentials("d1cbab74-823d-41aa-abb7-85848595")</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sh 'sudo -S &lt;&lt;&lt; "$JENKINS_PSW" sh test.sh'</span><br></pre></td></tr></table></figure>

<p>如果你有更好的方式，欢迎留言评论，谢谢。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/execute-sudo-without-password/" data-id="ckc5mu1vx003vswfofymfh3ii" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/execute-sudo-without-password/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">Shell</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/add-disqus-to-hexo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/add-disqus-to-hexo/" class="article-date">
  <time datetime="2019-07-07T12:20:50.000Z" itemprop="datePublished">2019-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hexo/">Hexo</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/add-disqus-to-hexo/">Hexo添加Disqus留言功能</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="在你的-Hexo-网站添加-Disqus"><a href="#在你的-Hexo-网站添加-Disqus" class="headerlink" title="在你的 Hexo 网站添加 Disqus"></a>在你的 Hexo 网站添加 Disqus</h2><p>去 Disqus 创建一个账号，在这个过程中有需要选择一个 shortname，完成后，你可以在设置页码找到你的 shortname</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;YOURSHORTNAMEHERE.disqus.com&#x2F;admin&#x2F;settings&#x2F;general</span><br></pre></td></tr></table></figure>

<p>在你Hexo博客里打开 _config.yml, 然后输入 disqus_shortnameand: YOURSHORTNAMEHERE，像这样：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disqus_shortname: myshortnamegoeshere</span><br><span class="line">comments: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>也需要更改_config.yml文件如下，例如我的：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改默认 url: http://yoursite.com 为：</span></span><br><span class="line">url: https://shenxianpeng.github.io</span><br></pre></td></tr></table></figure>

<p>复制这段代码到blog\themes\landscape\layout_partial\footer.ejs</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">var</span> disqus_shortname = <span class="string">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class="line">  &lt;% <span class="keyword">if</span> (page.permalink)&#123; %&gt;</span><br><span class="line">  <span class="keyword">var</span> disqus_url = <span class="string">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class="line">  &lt;% &#125; %&gt;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dsq = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">    dsq.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">    dsq.async = <span class="literal">true</span>;</span><br><span class="line">    dsq.src = <span class="string">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class="line">    (<span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>] || <span class="built_in">document</span>.getElementsByTagName(<span class="string">'body'</span>)[<span class="number">0</span>]).appendChild(dsq);</span><br><span class="line">  &#125;)();</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;% &#125; %&gt;</span></span><br></pre></td></tr></table></figure>

<p>也需要复制这些文件到 footer.ejs 到最底部：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"disqus_thread"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后最footer.ejs文件是这样的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (theme.sidebar === <span class="string">'bottom'</span>)&#123; %&gt;</span><br><span class="line">  &lt;%- partial(<span class="string">'_partial/sidebar'</span>) %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;% <span class="keyword">if</span> (config.disqus_shortname)&#123; %&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> disqus_shortname = <span class="string">'&lt;%= config.disqus_shortname %&gt;'</span>;</span><br><span class="line">    &lt;% <span class="keyword">if</span> (page.permalink)&#123; %&gt;</span><br><span class="line">    <span class="keyword">var</span> disqus_url = <span class="string">'&lt;%= page.permalink %&gt;'</span>;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> dsq = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">      dsq.type = <span class="string">'text/javascript'</span>;</span><br><span class="line">      dsq.async = <span class="literal">true</span>;</span><br><span class="line">      dsq.src = <span class="string">'//go.disqus.com/&lt;% if (page.comments)&#123; %&gt;embed.js&lt;% &#125; else &#123; %&gt;count.js&lt;% &#125; %&gt;'</span>;</span><br><span class="line">      (<span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>] || <span class="built_in">document</span>.getElementsByTagName(<span class="string">'body'</span>)[<span class="number">0</span>]).appendChild(dsq);</span><br><span class="line">    &#125;)();</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;% &#125; %&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;footer id="footer"&gt;</span></span><br><span class="line"><span class="regexp">  &lt;div class="outer"&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div id="footer-info" class="inner"&gt;</span></span><br><span class="line"><span class="regexp">      &amp;copy; &lt;%= date(new Date(), 'YYYY') %&gt; &lt;%= config.author || config.title %&gt;&lt;br&gt;</span></span><br><span class="line"><span class="regexp">      &lt;%= __('powered_by') %&gt; &lt;a href="http:/</span><span class="regexp">/hexo.io/</span><span class="string">" target="</span>_blank<span class="string">"&gt;Hexo&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/footer&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;div id="</span>disqus_thread<span class="string">"&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后清理和构建</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate &amp;&amp; hexo server</span><br></pre></td></tr></table></figure>

<p>现在你可以看到我的博客已经可以添加评论了 : )</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/add-disqus-to-hexo/" data-id="ckc5mu1vv003pswfobvx34zvm" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/add-disqus-to-hexo/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hexo/" rel="tag">Hexo</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/Jenkinsfile-example" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/Jenkinsfile-example/" class="article-date">
  <time datetime="2019-07-07T10:45:53.000Z" itemprop="datePublished">2019-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jenkins/">Jenkins</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/Jenkinsfile-example/">Jenkinsfile example - 实现交互、clone 多个仓库以及 git push</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>这个pipeline里包含了如下几个技术：</p>
<ul>
<li>如何使用其他机器，agent</li>
<li>如何使用环境变量，environment</li>
<li>如何在build前通过参数化输入，parameters</li>
<li>如何使用交互，input</li>
<li>如何同时clone多个repos</li>
<li>如何进行条件判断，anyOf</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent &#123;</span><br><span class="line">        node &#123;</span><br><span class="line">            label <span class="string">'windows-agent'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    environment &#123;</span><br><span class="line">        MY_CRE = credentials(<span class="string">"2aee7e0c-a728-4d9c-b25b-ad5451a12d"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    parameters &#123;</span><br><span class="line">        // Jenkins parameter</span><br><span class="line">        choice(</span><br><span class="line">            name: <span class="string">'REPO'</span>,</span><br><span class="line">            choices: [<span class="string">'repo1'</span>, <span class="string">'repo2'</span>, <span class="string">'repo3'</span>, <span class="string">'repo4'</span>],</span><br><span class="line">            description: <span class="string">'Required: pick a repo you want to build'</span>)</span><br><span class="line">        string(</span><br><span class="line">            name: <span class="string">'BRANCH'</span>,</span><br><span class="line">            defaultValue: <span class="string">''</span>,</span><br><span class="line">            description: <span class="string">'Required: chose a branch you want to checkout'</span>)</span><br><span class="line">        string(</span><br><span class="line">            name: <span class="string">'BUILD_NO'</span>,</span><br><span class="line">            defaultValue: <span class="string">''</span>,</span><br><span class="line">            description: <span class="string">'Required: input build number'</span>)</span><br><span class="line">        string(</span><br><span class="line">            name: <span class="string">'JIRA_NO'</span>,</span><br><span class="line">            defaultValue: <span class="string">''</span>,</span><br><span class="line">            description: <span class="string">'Optional: input jira ticket number for commit message'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">"Are you sure?"</span>)&#123;</span><br><span class="line">            steps&#123;</span><br><span class="line">                // make sure you want to start this build</span><br><span class="line">                input message: <span class="string">"<span class="variable">$&#123;REPO&#125;</span>/<span class="variable">$&#123;BRANCH&#125;</span>:<span class="variable">$&#123;BUILD_NO&#125;</span>, are you sure?"</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"I'm sure!"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'Git clone repos'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                // git <span class="built_in">clone</span> one repo <span class="built_in">source</span> code</span><br><span class="line">                checkout([</span><br><span class="line">                    <span class="variable">$class</span>: <span class="string">'GitSCM'</span>, branches: [[name: <span class="string">'refs/heads/$&#123;BRANCH&#125;'</span>]], browser: [<span class="variable">$class</span>: <span class="string">'GitHub'</span>, repoUrl: <span class="string">'https://github.com/$&#123;REPO&#125;'</span>], doGenerateSubmoduleConfigurations: <span class="literal">false</span>, extensions: [[<span class="variable">$class</span>: <span class="string">'CleanBeforeCheckout'</span>], [<span class="variable">$class</span>: <span class="string">'LocalBranch'</span>, localBranch: <span class="string">'**'</span>], [<span class="variable">$class</span>: <span class="string">'RelativeTargetDirectory'</span>, relativeTargetDir: <span class="string">'../$&#123;REPO&#125;'</span>]], submoduleCfg: [], userRemoteConfigs: [[credentialsId: <span class="string">'2aee7e0c-a728-4d9c-b25b'</span>, url: <span class="string">'https://github.com/$&#123;REPO&#125;.git'</span>]]])</span><br><span class="line"></span><br><span class="line">                // git <span class="built_in">clone</span> another repo <span class="built_in">source</span> code</span><br><span class="line">                checkout([</span><br><span class="line">                    <span class="variable">$class</span>: <span class="string">'GitSCM'</span>, branches: [[name: <span class="string">'refs/heads/$&#123;BRANCH&#125;'</span>]], browser: [<span class="variable">$class</span>: <span class="string">'GitHub'</span>, repoUrl: <span class="string">'https://github.com/$&#123;REPO&#125;'</span>], doGenerateSubmoduleConfigurations: <span class="literal">false</span>, extensions: [[<span class="variable">$class</span>: <span class="string">'CleanBeforeCheckout'</span>], [<span class="variable">$class</span>: <span class="string">'LocalBranch'</span>, localBranch: <span class="string">'**'</span>], [<span class="variable">$class</span>: <span class="string">'RelativeTargetDirectory'</span>, relativeTargetDir: <span class="string">'../$&#123;REPO&#125;'</span>]], submoduleCfg: [], userRemoteConfigs: [[credentialsId: <span class="string">'2aee7e0c-a728-4d9c-b25b'</span>, url: <span class="string">'https://github.com/$&#123;REPO&#125;.git'</span>]]])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'Build repo1 and repo2'</span>) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                // <span class="keyword">if</span> REPO=repo1 or REPO=repo2, execute build_repo12.sh</span><br><span class="line">                anyOf &#123;</span><br><span class="line">                    environment name: <span class="string">'REPO'</span>, value: <span class="string">'repo1'</span></span><br><span class="line">                    environment name: <span class="string">'REPO'</span>, value: <span class="string">'repo2'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh label: <span class="string">''</span>, script: <span class="string">'$&#123;REPO&#125;/build_repo12.sh $&#123;REPO&#125; $&#123;BUILD_NO&#125; $&#123;JIRA_NO&#125;'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'Build repo3 and repo4'</span>) &#123;</span><br><span class="line">            when &#123;</span><br><span class="line">                // <span class="keyword">if</span> REPO=repo3 or REPO=repo4, execute build_repo34.sh</span><br><span class="line">                anyOf &#123;</span><br><span class="line">                    environment name: <span class="string">'REPO'</span>, value: <span class="string">'repo3'</span></span><br><span class="line">                    environment name: <span class="string">'REPO'</span>, value: <span class="string">'repo4'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            steps &#123;</span><br><span class="line">                sh label: <span class="string">''</span>, script: <span class="string">'$&#123;REPO&#125;/build_repo34.sh $&#123;REPO&#125; $&#123;BUILD_NO&#125; $&#123;JIRA_NO&#125;'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        stage(<span class="string">'Git push to remote repo'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                // commit code to remote repo</span><br><span class="line">                sshagent([<span class="string">'2aee7e0c-a728-4d9c-b25b'</span>]) &#123;</span><br><span class="line">                    sh <span class="string">"git push https://%MY_CRE_USR%:%MY_CRE_PSW%@github.com/<span class="variable">$&#123;REPO&#125;</span>.git"</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/Jenkinsfile-example/" data-id="ckc5mu1vt003hswfo1hs0edm7" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/Jenkinsfile-example/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/07/git-management" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/git-management/" class="article-date">
  <time datetime="2019-07-07T09:55:18.000Z" itemprop="datePublished">2019-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/git/">Git</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/git-management/">Git 管理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="查找是否有遗漏提交"><a href="#查找是否有遗漏提交" class="headerlink" title="查找是否有遗漏提交"></a>查找是否有遗漏提交</h2><p>从一个分支找到所有的 commit 和 ticket 号，然后去另外一个分支去查找这些提交是否也在这个分支里。</p>
<p>找一个分支的所有 commit 和 ticket 号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 develop 分支上获取所有的 commit 和 ticket 号，然后根据 ticket 号进行排序</span></span><br><span class="line">git <span class="built_in">log</span> origin/develop --pretty=oneline --abbrev-commit | cut -d<span class="string">' '</span> -f2,1 | sort -t <span class="string">' '</span> -k 2 &gt;&gt; develop_involve_tickets.txt</span><br><span class="line"></span><br><span class="line">--pretty=oneline    <span class="comment"># 显示为一行</span></span><br><span class="line">--abbrev-commit     <span class="comment"># 显示短的提交号</span></span><br><span class="line"></span><br><span class="line">cut --<span class="built_in">help</span>          <span class="comment"># 切出来所需要的字段</span></span><br><span class="line">-d                  <span class="comment"># 字段分隔符, ' '分隔空格</span></span><br><span class="line">-f                  <span class="comment"># 只选择某些字段</span></span><br><span class="line"></span><br><span class="line">sort --<span class="built_in">help</span>         <span class="comment"># 利用 sort 将剪出来的字段进行排序</span></span><br><span class="line">-t                  <span class="comment"># 字段分隔， ' '分隔空格</span></span><br><span class="line">-k                  <span class="comment"># 通过键进行键定义排序;KEYDEF 给出位置和类型</span></span><br></pre></td></tr></table></figure>

<p>然后去另外一个分支去找是否有次提交</p>
<p>由于在 SVN 时代时，每次修改都会在描述里添加 ticket 号，所以切换到 master 分支后，直接搜索所有 ticket 号是否存在就好了.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">filename=<span class="string">'C:\develop_involve_tickets.txt'</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">read</span> line</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$line</span></span><br><span class="line">    var=`grep -ir <span class="variable">$line</span> src`</span><br><span class="line">    <span class="keyword">if</span> [[ -z <span class="variable">$var</span> ]];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"not found"</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$line</span> &gt;&gt; ../not_found_in_master.txt</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"found"</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$line</span> &gt;&gt; ../found_in_master.txt</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span> &lt; <span class="string">"<span class="variable">$filename</span>"</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/07/git-management/" data-id="ckc5mu1vw003sswfo2lp01q15" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/07/git-management/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">Git</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/06/multi-branch-pipeline" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/06/multi-branch-pipeline/" class="article-date">
  <time datetime="2019-06-25T14:15:42.000Z" itemprop="datePublished">2019-06-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/jenkins/">Jenkins</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/06/multi-branch-pipeline/">Multibranch Pipeline</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Problems"><a href="#Problems" class="headerlink" title="Problems"></a>Problems</h2><p>Like database product, it runs on multi-platform, but for software enginner they may only works on one platform, how they could identify their code works on all platform? manually build the various platforms? NO!</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>Most people would know we can use Jenkins pipeline, they may create multi Jenkins job for different stuation.</p>
<p>How to do it in an elegant way, I would want to share how to use multibranch pipeline to achieve.</p>
<ol>
<li>When create a pull request, auto parallel start simple build.</li>
<li>Reviewers can decide whether to merge base on build results.</li>
<li>After code merged, auto start full build.</li>
</ol>
<h2 id="Benefits"><a href="#Benefits" class="headerlink" title="Benefits"></a>Benefits</h2><p>What are the benefits:</p>
<ol>
<li>One Jenkins job and one pipeline can manage multi branches.</li>
<li>Do not need to compile platforms to verify, save huge time and machines.</li>
<li>Stop looking for other people’s mistakes, no one can break the build.</li>
<li>Builds can be generated quickly for QA testing</li>
</ol>
<h2 id="Jenkinsfile-example"><a href="#Jenkinsfile-example" class="headerlink" title="Jenkinsfile example"></a>Jenkinsfile example</h2><p>In case of reduce simple build time and let PR creater and reviewer know the builds status as soon as possbile, you may need to do something different here, like below, used when condition and branch variable to check it is a develop branch or pull request branch.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">when &#123;</span><br><span class="line">    branch <span class="string">'PR-*'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">when &#123;</span><br><span class="line">    branch <span class="string">'develop'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The entire code pipeline looks like this:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">// This Jenkinsfile is an explame <span class="keyword">for</span> multibranch pipeline</span><br><span class="line"></span><br><span class="line">pipeline &#123;</span><br><span class="line">    agent none</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">"All platform builds"</span>) &#123;</span><br><span class="line">            parallel &#123;</span><br><span class="line">                stage(<span class="string">"Windows build"</span>) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        node &#123;</span><br><span class="line">                            label <span class="string">'windows-vm01'</span></span><br><span class="line">                            customWorkspace <span class="string">'C:\\agent\\workspace\\blog'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(<span class="string">"PR build"</span>) &#123;</span><br><span class="line">                            when &#123;</span><br><span class="line">                                branch <span class="string">'PR-*'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                checkout scm</span><br><span class="line">                                dir(<span class="string">'src\\build'</span>) &#123;</span><br><span class="line">                                    bat label: <span class="string">''</span>, script: <span class="string">'build.bat PR'</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(<span class="string">"Release build"</span>) &#123;</span><br><span class="line">                            when &#123;</span><br><span class="line">                                branch <span class="string">'develop'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                cleanWs()</span><br><span class="line">                                checkout scm</span><br><span class="line">                                dir(<span class="string">'src\\build'</span>) &#123;</span><br><span class="line">                                    bat label: <span class="string">''</span>, script: <span class="string">'build.bat release'</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(<span class="string">"Deploy"</span>) &#123;</span><br><span class="line">                            <span class="built_in">echo</span> <span class="string">"====if you have more stage, can add stage like this==="</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(<span class="string">"Linux build"</span>) &#123;</span><br><span class="line">                    agent &#123;</span><br><span class="line">                        node &#123;</span><br><span class="line">                            label <span class="string">'linux-vm01'</span></span><br><span class="line">                            customWorkspace <span class="string">'/agent/workspace/blog'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    stages &#123;</span><br><span class="line">                        stage(<span class="string">"PR build"</span>) &#123;</span><br><span class="line">                            when &#123;</span><br><span class="line">                                branch <span class="string">'PR-*'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                checkout scm</span><br><span class="line">                                dir(<span class="string">'src/build'</span>) &#123;</span><br><span class="line">                                    bat label: <span class="string">''</span>, script: <span class="string">'build.sh PR'</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        stage(<span class="string">"Release build"</span>) &#123;</span><br><span class="line">                            when &#123;</span><br><span class="line">                                branch <span class="string">'develop'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            steps &#123;</span><br><span class="line">                                cleanWs()</span><br><span class="line">                                checkout scm</span><br><span class="line">                                dir(<span class="string">'src/build'</span>) &#123;</span><br><span class="line">                                    bat label: <span class="string">''</span>, script: <span class="string">'build.sh release'</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                stage(<span class="string">"AIX build"</span>)&#123;</span><br><span class="line">                    steps&#123;</span><br><span class="line">                        <span class="built_in">echo</span> <span class="string">"====same as windows/Linux example, can write the code here you need ===="</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/06/multi-branch-pipeline/" data-id="ckc5mu1vu003lswfo9ga3fu7k" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/06/multi-branch-pipeline/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/" rel="tag">Jenkins</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pipeline/" rel="tag">Pipeline</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/multi-branch/" rel="tag">multi-branch</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  
    <article id="post-2019/05/squishcoco" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/squishcoco/" class="article-date">
  <time datetime="2019-05-21T07:53:55.000Z" itemprop="datePublished">2019-05-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/devops/">DevOps</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/squishcoco/">Code Coverage - Squishcoco</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><ol>
<li>On windows platform</li>
<li>Installed Visual Studio 2010 or higher, I used VS2017 Professional</li>
<li>Install Squish Coco and Add-in</li>
</ol>
<h2 id="Add-in"><a href="#Add-in" class="headerlink" title="Add-in"></a>Add-in</h2><ul>
<li>go to ..squishcoco\Setup, see quishCocoVSIX2017.vsix, double click, reopen VS2017, squishcoco will be there</li>
</ul>
<h2 id="Create-a-project"><a href="#Create-a-project" class="headerlink" title="Create a project"></a>Create a project</h2><p>Start Visual Studio and create a new C++ application</p>
<ol>
<li>Click on “File→New→Project…” to pop up the new project wizard.</li>
<li>Choose a project type of “Visual C++2” and the “Win32 Console Application” template.</li>
<li>Enter a project name of squishcoco_sample, then click the “OK” button.</li>
<li>When the wizard’s second page appears, click the “Finish” button.</li>
</ol>
<p>At this stage the application is not yet instrumented, so now we will create a copy of the build.<br><img src="/2019/05/squishcoco/configuration-manager.png" alt="configuration-manager"></p>
<ol>
<li>Open the configuration manager by clicking “Build→Configuration Manager…”.</li>
<li>In the “Configuration” column, select “New…” in the combobox.</li>
<li>In the “New Project Configuration” dialog:<ol>
<li>Enter Code Coverage in the “Name” field,</li>
<li>Select Release or Debug in the “Copy settings from” selection dialog.</li>
<li>Click the “OK” button.</li>
</ol>
</li>
</ol>
<p>Add test code</p>
<p>squishcoco_sample.cpp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// squishcoco_sample.cpp : Defines the entry point for the console application.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdafx.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">int</span> <span class="title">myprint</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> _tmain(<span class="keyword">int</span> argc, _TCHAR* argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Enter your age: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;age);</span><br><span class="line">    <span class="keyword">if</span> (age &gt; <span class="number">0</span> &amp;&amp; age &lt;=<span class="number">40</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You're young guys\n"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (age &gt;<span class="number">40</span> &amp;&amp; age &lt;=<span class="number">70</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You're midle guys\n"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (age &gt; <span class="number">70</span> &amp;&amp; age &lt;=<span class="number">100</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You're old guys\n"</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"You're awesome\n"</span>);</span><br><span class="line"></span><br><span class="line">    myprint();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>myprint.cpp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">"stdafx.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">myprint</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span> (<span class="string">"you have call printf function\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Activate-instrumentation"><a href="#Activate-instrumentation" class="headerlink" title="Activate instrumentation"></a>Activate instrumentation</h2><p>use the Microsoft® Visual Studio® Add-In:<br><img src="/2019/05/squishcoco/squishcoco-add-in.png" alt="squishcoco-add-in"></p>
<ol>
<li>Click “Tools→Code Coverage Build Mode…” to pop up the Squish Coco wizard.</li>
<li>In the “Project:” selection dialog, select squishcoco_sample.</li>
<li>In the selection dialog “Configuration:”, select Code Coverage.</li>
<li>In the Configuration section at the bottom, select the radio button “Modify”, and then click on the button, “Enable code coverage for C++ projects”.</li>
</ol>
<p>The Code Coverage configuration has now been modified to generate code coverage information. The “SquishCoco” output window summarizes all the modifications that have been made:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">Modifying configuration &#39;Code Coverage&#39; for the project &#39;squishcoco_sample&#39; for the platform &#39;Code Coverage|Win32&#39;</span><br><span class="line">    Compiler Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    Linker Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    Librarian Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    File Specific Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended for the file &#39;squishcoco_sample.cpp&#39;</span><br><span class="line">Modifying configuration &#39;Code Coverage&#39; for the project &#39;squishcoco_sample&#39; for the platform &#39;Code Coverage|x64&#39;</span><br><span class="line">    Compiler Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    Linker Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    Librarian Configuration</span><br><span class="line">        Additional command line arguments &#39; --cs-exclude-file-abs-regex&#x3D;&quot;^.*\\squishcoco_sample\\[^\\]*$&quot; --cs-on --cs-condition --cs-line --cs-function --cs-hit --cs-full-instrumentation --cs-no-qt3 --cs-no-qt4 --cs-no-boost&#39; are appended</span><br><span class="line">    File Specific Configuration</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h2 id="Build-project"><a href="#Build-project" class="headerlink" title="Build project"></a>Build project</h2><p>Build project will cause the executable squishcoco_sample.exe to be built and the code coverage instrumentation file squishcoco_sample.exe.csmes to be generated</p>
<p>Double click on squishcoco_sample.exe.csmes to inspect this file in CoverageBrowser</p>
<p>Right now there is no code coverage statistics visible in CoverageBrowser, this is because the application has not yet been executed. Click on squishcoco_sample.cpp in the source list to display the main function. All the instrumented lines are shown grayed out, to indicate that nothing has been executed.</p>
<p>Now execute squishcoco_sample.exe by double clicking it. This will result in a file called squishcoco_sample.exe.csexe being generated. The file contains a code coverage snapshot which can be imported into Coverage Browser</p>
<ol>
<li>Click “File-&gt;Load Execution Report…”.</li>
<li>Select the “File” item and enter the path of the squishcoco_sample.exe.csexe file.</li>
<li>Click on the “Import” button.<br>This will cause the code coverage statistics to be updated. Now, in the source code window, the main function’s return statement will be colored green to indicate that this line has been executed.</li>
</ol>
<h2 id="Final-result"><a href="#Final-result" class="headerlink" title="Final result"></a>Final result</h2><p><img src="/2019/05/squishcoco/squishcoco-result.png" alt="squishcoco-result"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shenxianpeng.github.io/2019/05/squishcoco/" data-id="ckc5mu1vs003bswfo4ybf4t6l" class="article-share-link">Share</a>
      
        <a href="https://shenxianpeng.github.io/2019/05/squishcoco/#disqus_thread" class="article-comment-link">留言</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codecoverage/" rel="tag">CodeCoverage</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/squishcoco/" rel="tag">Squishcoco</a></li></ul>

    </footer>
    
    <script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </div>
  
</article>
  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/4/">prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/6/">next</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">Automation</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/devops/">DevOps</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">Git</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">Hexo</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/jenkins/">Jenkins</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linuxunix/">LinuxUnix</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mynotes/">MyNotes</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/snippet/">Snippet</a><span class="category-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/aix/" style="font-size: 10px;">AIX</a> <a href="/tags/ansicolor/" style="font-size: 10px;">AnsiColor</a> <a href="/tags/artifactory/" style="font-size: 13.33px;">Artifactory</a> <a href="/tags/authorization/" style="font-size: 10px;">Authorization</a> <a href="/tags/automation/" style="font-size: 17.78px;">Automation</a> <a href="/tags/azure/" style="font-size: 10px;">Azure</a> <a href="/tags/batch/" style="font-size: 10px;">Batch</a> <a href="/tags/bitbucket/" style="font-size: 12.22px;">Bitbucket</a> <a href="/tags/blackduck/" style="font-size: 10px;">Blackduck</a> <a href="/tags/blog/" style="font-size: 12.22px;">Blog</a> <a href="/tags/branch/" style="font-size: 10px;">Branch</a> <a href="/tags/c/" style="font-size: 14.44px;">C</a> <a href="/tags/cd/" style="font-size: 10px;">CD</a> <a href="/tags/ci/" style="font-size: 10px;">CI</a> <a href="/tags/cleanup/" style="font-size: 10px;">Cleanup</a> <a href="/tags/codecoverage/" style="font-size: 11.11px;">CodeCoverage</a> <a href="/tags/detect/" style="font-size: 10px;">Detect</a> <a href="/tags/devops/" style="font-size: 12.22px;">DevOps</a> <a href="/tags/docker/" style="font-size: 12.22px;">Docker</a> <a href="/tags/flask/" style="font-size: 10px;">Flask</a> <a href="/tags/framework/" style="font-size: 10px;">Framework</a> <a href="/tags/git/" style="font-size: 16.67px;">Git</a> <a href="/tags/github/" style="font-size: 10px;">GitHub</a> <a href="/tags/hp-ux/" style="font-size: 10px;">HP-UX</a> <a href="/tags/hexo/" style="font-size: 15.56px;">Hexo</a> <a href="/tags/interview/" style="font-size: 10px;">Interview</a> <a href="/tags/jfrog/" style="font-size: 12.22px;">JFrog</a> <a href="/tags/jmeter/" style="font-size: 10px;">JMeter</a> <a href="/tags/java/" style="font-size: 10px;">Java</a> <a href="/tags/javascript/" style="font-size: 12.22px;">Javascript</a> <a href="/tags/jenkins/" style="font-size: 20px;">Jenkins</a> <a href="/tags/linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/nfs/" style="font-size: 10px;">NFS</a> <a href="/tags/nightwatch/" style="font-size: 18.89px;">Nightwatch</a> <a href="/tags/pipeline/" style="font-size: 16.67px;">Pipeline</a> <a href="/tags/python/" style="font-size: 11.11px;">Python</a> <a href="/tags/release/" style="font-size: 10px;">Release</a> <a href="/tags/selenium/" style="font-size: 10px;">Selenium</a> <a href="/tags/shell/" style="font-size: 12.22px;">Shell</a> <a href="/tags/solaris/" style="font-size: 10px;">Solaris</a> <a href="/tags/squash/" style="font-size: 10px;">Squash</a> <a href="/tags/squishcoco/" style="font-size: 10px;">Squishcoco</a> <a href="/tags/stats/" style="font-size: 11.11px;">Stats</a> <a href="/tags/summary/" style="font-size: 10px;">Summary</a> <a href="/tags/synopsys/" style="font-size: 10px;">Synopsys</a> <a href="/tags/test/" style="font-size: 10px;">Test</a> <a href="/tags/testng/" style="font-size: 10px;">TestNG</a> <a href="/tags/thought/" style="font-size: 12.22px;">Thought</a> <a href="/tags/tips/" style="font-size: 11.11px;">Tips</a> <a href="/tags/translate/" style="font-size: 10px;">Translate</a> <a href="/tags/troubleshooting/" style="font-size: 13.33px;">Troubleshooting</a> <a href="/tags/unix/" style="font-size: 12.22px;">UNIX</a> <a href="/tags/ubuntu/" style="font-size: 12.22px;">Ubuntu</a> <a href="/tags/vpn/" style="font-size: 10px;">VPN</a> <a href="/tags/virtualbox/" style="font-size: 10px;">VirtualBox</a> <a href="/tags/webhooks/" style="font-size: 11.11px;">Webhooks</a> <a href="/tags/work/" style="font-size: 14.44px;">Work</a> <a href="/tags/cppcheck/" style="font-size: 10px;">cppcheck</a> <a href="/tags/multi-branch/" style="font-size: 10px;">multi-branch</a> <a href="/tags/performance/" style="font-size: 10px;">performance</a> <a href="/tags/vscode/" style="font-size: 11.11px;">vscode</a> <a href="/tags/write/" style="font-size: 10px;">write</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/about-my-wechat-official-account/">一名软件测试工程师的成长之路</a>
          </li>
        
          <li>
            <a href="/2020/06/Jenkins-tips-2/">《Jenkins Tips 002》 处理 Shell 返回的字符串成字符数组</a>
          </li>
        
          <li>
            <a href="/2020/06/Jenkins-tips-1/">《Jenkins Tips 001》 忽略 Shell 步骤中的故障</a>
          </li>
        
          <li>
            <a href="/2020/06/vm-status-check-via-jenkins/">这也能用Jenkins？快速实现一个定期批量登录远程虚拟机并支持添加新的主机名称的Job</a>
          </li>
        
          <li>
            <a href="/2020/06/Java-net-SocketException-on-AIX/">解决 Jenkins Artifactory Plugin 仅在 AIX 上传制品到 https 协议的 Artifactory 失败的问题</a>
          </li>
        
          <li>
            <a href="/2020/05/programmers-read-and-write/">从 “会写程序的干不过会写PPT的” —— 聊程序员写作</a>
          </li>
        
          <li>
            <a href="/2020/05/jenkins-pipeline-linter-connector/">如何确保提交 Jenkins Pipeline 前没有语法错误</a>
          </li>
        
          <li>
            <a href="/2020/05/nightwatch-v1-3/">Nightwarch v1.3 介绍</a>
          </li>
        
          <li>
            <a href="/2020/05/jmeter-performance-testing/">How to use JMeter to do Performance Testing</a>
          </li>
        
          <li>
            <a href="/2020/05/sync-from-bitbucket-to-github/">Synchronize from Bitbucket to GitHub via Jenkins</a>
          </li>
        
          <li>
            <a href="/2020/04/Bitbucket-webhooks-cn/">Jenkins 与 Bitbucket Webhooks 的配置和使用</a>
          </li>
        
          <li>
            <a href="/2020/04/Bitbucket-webhooks/">Bitbucket Webhooks Configuration</a>
          </li>
        
          <li>
            <a href="/2020/04/Jenkins-troubleshooting-1/">三种方法解决 Jenkins 声明式流水线 Exception Method code too large !</a>
          </li>
        
          <li>
            <a href="/2020/04/Top-30-DevOps-Interview-Questions/">DevOps Top 30+ 面试问题</a>
          </li>
        
          <li>
            <a href="/2020/03/Best-14-CI-CD-Tools-in-2020/">2020年务必知道的最好用的14款CI/CD工具</a>
          </li>
        
          <li>
            <a href="/2020/03/maintaining-a-git-gepository/">如何给你的 Git 仓库“瘦身”</a>
          </li>
        
          <li>
            <a href="/2020/02/cppcheck/">一款免费的 C/C++ 静态代码分析工具 Cppcheck 与 Jenkins 集成</a>
          </li>
        
          <li>
            <a href="/2020/02/Setup-Linux-in-VirtualBox/">用 VirtualBox 配置一台 Linux 虚拟机</a>
          </li>
        
          <li>
            <a href="/2020/02/linux-tips/">最有用的 Linux 命令行技巧</a>
          </li>
        
          <li>
            <a href="/2020/02/hpxu-tips/">HP-UX 安装工具以及一些使用总结</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


  
</aside>
<script data-ad-client="ca-pub-3986315287795783" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        
      </div>
      

<!-- 
  <script>
    var disqus_shortname = 'shenxianpeng';
    
    var disqus_url = 'https://shenxianpeng.github.io/about/index.html';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//go.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
 -->

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Xianpeng Shen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

<div id="disqus_thread"></div>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
  <script>
    var disqus_shortname = 'shenxianpeng';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>